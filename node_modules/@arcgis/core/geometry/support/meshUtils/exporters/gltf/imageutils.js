/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import"../../../../../core/has.js";import{isSome as t,isNone as e}from"../../../../../core/maybe.js";import n from"../../../../../core/Error.js";import{create as r}from"../../../../../core/promiseUtils.js";function o(e){const n=i(e);return t(n)?n.toDataURL():""}async function a(t){const o=i(t);if(e(o))throw new n("imageToArrayBuffer","Unsupported image type");const a=async t=>{if(!t)throw new n("imageToArrayBuffer","Unable to convert image to PNG");const e=new FileReader,o=r((t=>{e.addEventListener("loadend",(()=>{t(e.result)}))}));return e.readAsArrayBuffer(t),o};if(o.toBlob)return r(((t,e)=>{o.toBlob((n=>{a(n).then(t,e)}),"image/png")}));if("msToBlob"in o)return a(o.msToBlob());throw new n("imageToArrayBuffer","Could not convert canvas to blob")}function i(t){if(t instanceof HTMLCanvasElement)return t;if(t instanceof HTMLVideoElement)return null;const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");return t instanceof HTMLImageElement?n.drawImage(t,0,0,t.width,t.height):t instanceof ImageData&&n.putImageData(t,t.width,t.height),e}function s(t){const e=[],n=new Uint8Array(t);for(let t=0;t<n.length;t++)e.push(String.fromCharCode(n[t]));return"data:application/octet-stream;base64,"+btoa(e.join(""))}function c(t){if(t.byteLength<8)return!1;const e=new Uint8Array(t);return 137===e[0]&&80===e[1]&&78===e[2]&&71===e[3]&&13===e[4]&&10===e[5]&&26===e[6]&&10===e[7]}export{s as encodeBase64DataUri,a as imageToArrayBuffer,o as imageToDataURI,c as isArrayBufferPNG};
