/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import t from"../../../core/Logger.js";import{Z as e,c as r}from"../../../chunks/vec3f64.js";import{g as o,t as s,i as n}from"../../../chunks/vec3.js";import{getSphericalPCPF as i}from"../../projectionEllipsoid.js";import{i as a,r as c}from"../../../chunks/mat4.js";import{projectPointToVector as f,computeLinearTransformation as m}from"../../projection.js";import{a as p}from"../../../chunks/mat3f64.js";import{a as u}from"../../../chunks/mat4f64.js";import{a as l}from"../../../chunks/quatf64.js";import{a as g}from"../../../chunks/vec4f64.js";import{f as h}from"../../../chunks/mat3.js";import{projectToECEF as j,projectNormalToECEF as x,projectTangentToECEF as k,projectFromECEF as v,projectNormalFromECEF as A,projectTangentFromECEF as b}from"./projection.js";import{s as d,m as w,g as y}from"../../../chunks/quat.js";const R=t.getLogger("esri.geometry.support.meshUtils.rotate");function F(t,e,r){if(!t.vertexAttributes||!t.vertexAttributes.position||0===e[3])return;const o=t.spatialReference,n=o.isWGS84||o.isWebMercator&&(!r||!1!==r.geographic),a=r&&r.origin||t.extent.center;n?function(t,e,r){const o=t.spatialReference,n=i(o),a=M;f(r,a,n)||f(t.extent.center,a,n);const c=t.vertexAttributes.position,p=t.vertexAttributes.normal,u=t.vertexAttributes.tangent,l=new Float64Array(c.length),g=new Float32Array(p?p.length:0),d=new Float32Array(u?u.length:0);m(n,a,E,n),h(G,E);const w=W;s(W,e,G),w[3]=e[3],j(c,o,l),p&&x(p,c,l,o,g);u&&k(u,c,l,o,d);L(l,w,3,a),v(l,c,o),p&&(L(g,w,3),A(g,c,l,o,p));u&&(L(d,w,4),b(d,c,l,o,u));t.clearCache()}(t,e,a):function(t,e,r){const o=M;if(!f(r,o,t.spatialReference)){const e=t.extent.center;o[0]=e.x,o[1]=e.y,o[2]=e.z,R.error(`Failed to project specified origin (wkid:${r.spatialReference.wkid}) to mesh spatial reference (wkid:${t.spatialReference.wkid}). Using mesh extent.center instead`)}L(t.vertexAttributes.position,e,3,o),L(t.vertexAttributes.normal,e,3),L(t.vertexAttributes.tangent,e,4),t.clearCache()}(t,e,a)}function q(t,e,r){return o(r,t),r[3]=e,r}function C(t,e,r){return d($,t,t[3]),d(z,e,e[3]),w($,z,$),r[3]=y(r,$),r}function L(t,r,o,s=e){if(t){a(E),c(E,E,r[3],r);for(let e=0;e<t.length;e+=o){for(let r=0;r<3;r++)U[r]=t[e+r]-s[r];n(U,U,E);for(let r=0;r<3;r++)t[e+r]=U[r]+s[r]}}}const U=r(),W=g(),$=l(),z=l(),E=u(),G=p(),M=r();export{q as axisAngleFrom,C as axisAngleMultiply,F as rotate};
