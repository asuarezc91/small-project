/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import e from"../../../core/Logger.js";import{Z as t,c as r}from"../../../chunks/vec3f64.js";import{a as o}from"../../../chunks/vec3.js";import{getSphericalPCPF as i}from"../../projectionEllipsoid.js";import{projectPointToVector as n}from"../../projection.js";import{projectToECEF as s,projectNormalToECEF as c,projectTangentToECEF as a,projectFromECEF as p,projectNormalFromECEF as f,projectTangentFromECEF as l}from"./projection.js";const m=e.getLogger("esri.geometry.support.meshUtils.scale");function g(e,t,r){if(!e.vertexAttributes||!e.vertexAttributes.position)return;const o=e.spatialReference,g=o.isWGS84||o.isWebMercator&&(!r||!1!==r.geographic),h=r&&r.origin||e.extent.center;g?function(e,t,r){const o=e.spatialReference,m=i(o),g=x;n(r,g,m)||n(e.extent.center,g,m);const h=e.vertexAttributes.position,j=e.vertexAttributes.normal,A=e.vertexAttributes.tangent,d=new Float64Array(h.length),v=new Float32Array(j?j.length:0),b=new Float32Array(A?A.length:0);s(h,o,d),j&&c(j,h,d,o,v);A&&a(A,h,d,o,b);u(d,t,g),p(d,h,o),j&&f(v,h,d,o,j);A&&l(b,h,d,o,A);e.clearCache()}(e,t,h):function(e,t,r){const o=x;if(!n(r,o,e.spatialReference)){const t=e.extent.center;o[0]=t.x,o[1]=t.y,o[2]=t.z,m.error(`Failed to project specified origin (wkid:${r.spatialReference.wkid}) to mesh spatial reference (wkid:${e.spatialReference.wkid}). Using mesh extent.center instead`)}u(e.vertexAttributes.position,t,o),e.clearCache()}(e,t,h)}function u(e,r,i=t){if(e)for(let t=0;t<e.length;t+=3){for(let r=0;r<3;r++)h[r]=e[t+r]-i[r];o(h,h,r);for(let r=0;r<3;r++)e[t+r]=h[r]+i[r]}}const h=r(),x=r();export{g as scale};
