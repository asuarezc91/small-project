/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import e from"../../geometry/Geometry.js";import r from"../../geometry/Point.js";import n from"../../geometry/Extent.js";import t from"../../geometry/Multipoint.js";import{isClockwise as i}from"../../geometry/support/coordsUtils.js";import o from"../../geometry/Polygon.js";import a from"../../geometry/Polyline.js";import{fromJSON as l}from"../../geometry/support/jsonUtils.js";import s from"../ImmutablePointArray.js";import{p as f,h as c,o as u,r as m,H as g,J as p,v as h,b as w,e as y,f as E,a as R,i as I,q as A,j as F,n as S,K as d}from"../../chunks/languageUtils.js";import j from"../Dictionary.js";import G from"../Feature.js";import{angle2D as O,angleBetween2D as b,bearing2D as x,bearingBetween2D as N,pathsSelfIntersecting as J}from"./centroid.js";function D(D,P){D.ringisclockwise=function(e,n){return P(e,n,(function(e,n,t){f(t,1,1);let o=[],a=!1,l=!1;if(null===t[0])return!1;if(c(t[0])){for(const e of t[0]){if(!(e instanceof r))throw new Error("Invalid Argument");o.push(e.hasZ?e.hasM?[e.x,e.y,e.z,e.m]:[e.x,e.y,e.z]:[e.x,e.y])}o.length>0&&(a=t[0][0].hasZ,l=t[0][0].hasM)}else if(t[0]instanceof s)o=t[0]._elements,o.length>0&&(a=t[0]._hasZ,l=t[0]._hasM);else{if(!u(t[0]))throw new Error("Invalid Argument");for(const e of t[0].toArray()){if(!(e instanceof r))throw new Error("Invalid Argument");o.push(e.hasZ?e.hasM?[e.x,e.y,e.z,e.m]:[e.x,e.y,e.z]:[e.x,e.y])}o.length>0&&(a=t[0].get(0).hasZ,l=t[0].get(0).hasM)}return!(o.length<3)&&i(o,l,a)}))},D.polygon=function(e,r){return P(e,r,(function(r,n,t){f(t,1,1);let i=null;if(t[0]instanceof j){if(i=m(G.parseGeometryFromDictionary(t[0]),e.spatialReference),i instanceof o==!1)throw new Error("Illegal Parameter")}else i=t[0]instanceof o?l(t[0].toJSON()):m(new o(JSON.parse(t[0])),e.spatialReference);if(null!==i&&!1===i.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return g(i)}))},D.polyline=function(e,r){return P(e,r,(function(r,n,t){f(t,1,1);let i=null;if(t[0]instanceof j){if(i=m(G.parseGeometryFromDictionary(t[0]),e.spatialReference),i instanceof a==!1)throw new Error("Illegal Parameter")}else i=t[0]instanceof a?l(t[0].toJSON()):m(new a(JSON.parse(t[0])),e.spatialReference);if(null!==i&&!1===i.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return g(i)}))},D.point=function(e,n){return P(e,n,(function(n,t,i){f(i,1,1);let o=null;if(i[0]instanceof j){if(o=m(G.parseGeometryFromDictionary(i[0]),e.spatialReference),o instanceof r==!1)throw new Error("Illegal Parameter")}else o=i[0]instanceof r?l(i[0].toJSON()):m(new r(JSON.parse(i[0])),e.spatialReference);if(null!==o&&!1===o.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return g(o)}))},D.multipoint=function(e,r){return P(e,r,(function(r,n,i){f(i,1,1);let o=null;if(i[0]instanceof j){if(o=m(G.parseGeometryFromDictionary(i[0]),e.spatialReference),o instanceof t==!1)throw new Error("Illegal Parameter")}else o=i[0]instanceof t?l(i[0].toJSON()):m(new t(JSON.parse(i[0])),e.spatialReference);if(null!==o&&!1===o.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return g(o)}))},D.extent=function(e,i){return P(e,i,(function(i,s,c){c=p(c),f(c,1,1);let u=null;if(c[0]instanceof j)u=m(G.parseGeometryFromDictionary(c[0]),e.spatialReference);else if(c[0]instanceof r){const e={xmin:c[0].x,ymin:c[0].y,xmax:c[0].x,ymax:c[0].y,spatialReference:c[0].spatialReference.toJSON()},r=c[0];r.hasZ?(e.zmin=r.z,e.zmax=r.z):r.hasM&&(e.mmin=r.m,e.mmax=r.m),u=l(e)}else u=c[0]instanceof o||c[0]instanceof a||c[0]instanceof t?l(c[0].extent.toJSON()):c[0]instanceof n?l(c[0].toJSON()):m(new n(JSON.parse(c[0])),e.spatialReference);if(null!==u&&!1===u.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return g(u)}))},D.geometry=function(e,r){return P(e,r,(function(r,n,t){f(t,1,1);let i=null;if(i=t[0]instanceof G?m(t[0].geometry(),e.spatialReference):t[0]instanceof j?m(G.parseGeometryFromDictionary(t[0]),e.spatialReference):m(l(JSON.parse(t[0])),e.spatialReference),null!==i&&!1===i.spatialReference.equals(e.spatialReference))throw new Error("Cannot create Geometry in this SpatialReference. Engine is using a different spatial reference.");return g(i)}))},D.setgeometry=function(r,n){return P(r,n,(function(r,n,t){if(f(t,2,2),!(t[0]instanceof G))throw new Error("Illegal Argument");if(!0===t[0].immutable)throw new Error("Feature is Immutable");if(!(t[1]instanceof e||null===t[1]))throw new Error("Illegal Argument");return t[0]._geometry=t[1],h}))},D.feature=function(r,n){return P(r,n,(function(n,t,i){if(0===i.length)throw new Error("Missing Parameters");let o=null;if(1===i.length)if(w(i[0]))o=G.fromJson(JSON.parse(i[0]));else if(i[0]instanceof G)o=G.createFromArcadeFeature(i[0]);else if(i[0]instanceof e)o=G.createFromGraphicLikeObject(i[0],null,null);else{if(!(i[0]instanceof j))throw new Error("Illegal Argument");{let e=i[0].hasField("geometry")?i[0].field("geometry"):null,r=i[0].hasField("attributes")?i[0].field("attributes"):null;null!==e&&e instanceof j&&(e=G.parseGeometryFromDictionary(e)),null!==r&&(r=G.parseAttributesFromDictionary(r)),o=G.createFromGraphicLikeObject(e,r,null)}}else if(2===i.length){let r=null,n=null;if(null!==i[0])if(i[0]instanceof e)r=i[0];else{if(!(r instanceof j))throw new Error("Illegal Argument");r=G.parseGeometryFromDictionary(i[0])}if(null!==i[1]){if(!(i[1]instanceof j))throw new Error("Illegal Argument");n=G.parseAttributesFromDictionary(i[1])}o=G.createFromGraphicLikeObject(r,n,null)}else{let r=null;const n={};if(null!==i[0])if(i[0]instanceof e)r=i[0];else{if(!(r instanceof j))throw new Error("Illegal Argument");r=G.parseGeometryFromDictionary(i[0])}for(let e=1;e<i.length;e+=2){const r=y(i[e]),t=i[e+1];if(!(null==t||w(t)||isNaN(t)||E(t)||R(t)||I(t)))throw new Error("Illegal Argument");if(A(t)||!1===F(t))throw new Error("Illegal Argument");n[r]=t===h?null:t}o=G.createFromGraphicLikeObject(r,n,null)}return o._geometry=m(o.geometry(),r.spatialReference),o.immutable=!1,o}))},D.dictionary=function(e,r){return P(e,r,(function(e,r,n){if(0===n.length){const e=new j;return e.immutable=!1,e}if(1===n.length&&w(n[0]))try{const e=JSON.parse(n[0]),r=j.convertObjectToArcadeDictionary(e);return r.immutable=!1,r}catch(e){throw new Error("Missing Parameters or Illegal Json")}if(n.length%2!=0)throw new Error("Missing Parameters");const t={};for(let e=0;e<n.length;e+=2){const r=y(n[e]),i=n[e+1];if(!(null==i||w(i)||isNaN(i)||E(i)||R(i)||I(i)||c(i)||u(i)))throw new Error("Illegal Argument");if(A(i))throw new Error("Illegal Argument");t[r]=i===h?null:i}const i=new j(t);return i.immutable=!1,i}))},D.haskey=function(e,r){return P(e,r,(function(e,r,n){f(n,2,2);const t=y(n[1]);if(n[0]instanceof G)return n[0].hasField(t);if(n[0]instanceof j)return n[0].hasField(t);throw new Error("Illegal Argument")}))},D.indexof=function(e,r){return P(e,r,(function(e,r,n){f(n,2,2);const t=n[1];if(c(n[0])){for(let e=0;e<n[0].length;e++)if(S(t,n[0][e]))return e;return-1}if(u(n[0])){const e=n[0].length();for(let r=0;r<e;r++)if(S(t,n[0].get(r)))return r;return-1}throw new Error("Illegal Argument")}))},D.angle=function(e,n){return P(e,n,(function(e,n,t){if(t=p(t),f(t,2,3),!(t[0]instanceof r))throw new Error("Illegal Argument");if(!(t[1]instanceof r))throw new Error("Illegal Argument");if(t.length>2&&!(t[2]instanceof r))throw new Error("Illegal Argument");return 2===t.length?O(t[0],t[1]):b(t[0],t[1],t[2])}))},D.bearing=function(e,n){return P(e,n,(function(e,n,t){if(t=p(t),f(t,2,3),!(t[0]instanceof r))throw new Error("Illegal Argument");if(!(t[1]instanceof r))throw new Error("Illegal Argument");if(t.length>2&&!(t[2]instanceof r))throw new Error("Illegal Argument");return 2===t.length?x(t[0],t[1]):N(t[0],t[1],t[2])}))},D.isselfintersecting=function(e,r){return P(e,r,(function(r,n,i){i=p(i),f(i,1,1);let l=i[0];if(l instanceof o)return l.isSelfIntersecting;if(l instanceof a)return l=l.paths,J(l);if(l instanceof t){const e=l.points;for(let r=0;r<e.length;r++)for(let n=0;n<e.length;n++)if(n!==r){let t=!0;for(let i=0;i<e[r].length;i++)if(e[r][i]!==e[n][i]){t=!1;break}if(!0===t)return!0}}return!(!c(l)&&!u(l))&&(l=d(l,e.spatialReference),null!==l&&(l=l.paths),J(l))}))}}export{D as registerFunctions};
