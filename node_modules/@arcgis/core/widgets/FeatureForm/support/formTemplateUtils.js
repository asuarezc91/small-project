/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import e from"../../../layers/support/RangeDomain.js";import i from"../FieldConfig.js";import n from"../FieldGroupConfig.js";function t(e){var i;const n={},t=[];return null==(i=e.expressionInfos)||i.map((e=>n[e.name]=e.expression)),{config:l(e.elements,n,t),encounteredUnsupportedTypes:t}}function l(t,r,o,p=!0){return t.map((t=>{if("field"===t.type)return function(n,t,l){const{description:r,domain:o,editable:p,fieldName:s,hint:a,input:u,label:m,requiredExpression:d,visibilityExpression:f}=n,y=t[d]||null,c=t[f]||null,g=new i({description:r,domain:o,editable:p,hint:a,label:m,name:s,requiredExpression:y,visibilityExpression:c});if(u)if("text-area"===u.type||"text-box"===u.type)g.editorType=u.type,g.minLength=u.minLength,g.maxLength=u.maxLength;else if("datetime-picker"===u.type){g.editorType=u.type,g.includeTime=u.includeTime;const{max:i,min:n}=u;if(i||n){const t="range"===(null==o?void 0:o.type)?Math.min(null==i?void 0:i.getTime(),o.maxValue):null==i?void 0:i.getTime(),l="range"===(null==o?void 0:o.type)?Math.max(null==n?void 0:n.getTime(),o.minValue):null==n?void 0:n.getTime();g.domain=new e({maxValue:t,minValue:l,name:"__internal-range-domain-based-on-datetime-picker-input__"})}}else l.push({type:"unsupported-input-type",details:u});return g}(t,r,o);if("group"===t.type){if(!p)return o.push({type:"nested-group",details:t}),null;const e=r[t.visibilityExpression]||null;return new n({description:t.description,state:t.initialState,fieldConfig:l(t.elements,r,o,!1),label:t.label,visibilityExpression:e})}return o.push({type:"unsupported-element-type",details:t}),null})).filter((e=>!!e))}export{t as fieldConfigsFromFormTemplate};
