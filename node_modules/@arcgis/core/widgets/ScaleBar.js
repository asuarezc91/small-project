/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import"../core/has.js";import"../core/Logger.js";import{property as s}from"../core/accessorSupport/decorators/property.js";import{aliasOf as r}from"../core/accessorSupport/decorators/aliasOf.js";import{cast as t}from"../core/accessorSupport/decorators/cast.js";import{subclass as i}from"../core/accessorSupport/decorators/subclass.js";import"../core/urlUtils.js";import"../core/uuid.js";import"../portal/support/resourceExtension.js";import{createScreenPoint as o}from"../core/screenUtils.js";import{whenTrue as a,watch as l}from"../core/watchUtils.js";import"./support/widgetUtils.js";import{messageBundle as n}from"./support/decorators/messageBundle.js";import{renderable as c}from"./support/decorators/renderable.js";import{j as d}from"../chunks/index.js";import p from"./Widget.js";import u from"./ScaleBar/ScaleBarViewModel.js";const m="esri-scale-bar esri-widget",h="esri-scale-bar__label-container",_="esri-scale-bar__label-container--ruler",b="esri-scale-bar__label-container--line",v="esri-scale-bar__label-container--top",w="esri-scale-bar__label-container--bottom",f="esri-scale-bar__label",y="esri-scale-bar__line",g="esri-scale-bar__line--top",j="esri-scale-bar__line--bottom",S="esri-scale-bar__ruler",U="esri-scale-bar__ruler-block",M="esri-scale-bar__bar-container",k="esri-scale-bar__bar-container--ruler",B="esri-scale-bar__bar-container--line",R="esri-disabled";function O(e){return 2*e}let x=class extends p{constructor(e,s){super(e,s),this.label=void 0,this.messages=null,this.unit="non-metric",this.view=null,this.viewModel=new u}initialize(){this.own([a(this,"view.stationary",(()=>this.scheduleRender())),l(this,["view.center","view.scale","view.zoom"],(()=>{this.view.stationary&&this.scheduleRender()}))])}set style(e){const s="dual"===this.unit?"line":e;this._set("style",s)}castStyle(e){return"line"===e?e:"ruler"}castUnit(e){return"metric"===e||"dual"===e?e:"non-metric"}render(){const e="disabled"===this.get("viewModel.state"),s={[R]:e};let r,t;if(!e){const{unit:e,style:s}=this,i="metric"===e||"dual"===e,o=50;if("non-metric"===e||"dual"===e){const e=this.viewModel.getScaleBarProperties(o,"non-metric");e&&(t="ruler"===s?this._renderRuler(e):this._renderLine(e,"bottom"))}if(i){const e=this.viewModel.getScaleBarProperties(o,"metric");e&&(r="ruler"===s?this._renderRuler(e):this._renderLine(e,"top"))}}return d("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes(m,s)},r,t)}_renderRuler(e){const s=O(Math.round(e.length)),{messages:r}=this,t=r[e.unit]||r.unknownUnit,i=`${O(e.value)} ${t}`;return d("div",{class:this.classes(M,k),key:"esri-scale-bar__ruler"},d("div",{class:S,styles:{width:`${s}px`}},d("div",{class:U}),d("div",{class:U}),d("div",{class:U}),d("div",{class:U})),d("div",{class:this.classes(h,_)},d("div",{class:f},"0"),d("div",{class:f},i)))}_renderLine(e,s){const{messages:r}=this,t=r[e.unit]||r.unknownUnit,i=`${O(e.value)} ${t}`,o={[v]:"top"===s,[w]:"bottom"===s},a=d("div",{class:this.classes(h,b,o),key:"esri-scale-bar__label"},d("div",{class:f},i)),l={[g]:"top"===s,[j]:"bottom"===s},n=O(Math.round(e.length)),c=d("div",{class:this.classes(y,l),key:"esri-scale-bar__line",styles:{width:`${n}px`}});return d("div",{class:this.classes(M,B),key:"esri-scale-bar__line-container"},[c,a])}_handleRootCreateOrUpdate(e){const s=this.viewModel;if(s){const r=e.getBoundingClientRect(),t=r.left+window.pageXOffset,i=r.top+window.pageYOffset;s.scaleComputedFrom=o(t,i)}}};e([s({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],x.prototype,"label",void 0),e([s(),c(),n("esri/widgets/ScaleBar/t9n/ScaleBar")],x.prototype,"messages",void 0),e([s({dependsOn:["unit"]}),c()],x.prototype,"style",null),e([t("style")],x.prototype,"castStyle",null),e([s(),c()],x.prototype,"unit",void 0),e([t("unit")],x.prototype,"castUnit",null),e([r("viewModel.view"),c()],x.prototype,"view",void 0),e([s(),c(["viewModel.state"])],x.prototype,"viewModel",void 0),x=e([i("esri.widgets.ScaleBar")],x);var C=x;export default C;
