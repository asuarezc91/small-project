/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import"../../core/has.js";import{isSome as s}from"../../core/maybe.js";import"../../core/Logger.js";import{property as r}from"../../core/accessorSupport/decorators/property.js";import{aliasOf as t}from"../../core/accessorSupport/decorators/aliasOf.js";import{cast as i}from"../../core/accessorSupport/decorators/cast.js";import{subclass as o}from"../../core/accessorSupport/decorators/subclass.js";import"../../core/urlUtils.js";import"../../core/uuid.js";import"../../portal/support/resourceExtension.js";import a from"../../Color.js";import l from"../../renderers/support/ClassBreakInfo.js";import{storeNode as n}from"../support/widgetUtils.js";import{messageBundle as m}from"../support/decorators/messageBundle.js";import{renderable as d}from"../support/decorators/renderable.js";import{j as p}from"../../chunks/index.js";import{getFillFromColor as c}from"./support/utils.js";import{SmartMappingSliderBase as u}from"./SmartMappingSliderBase.js";import h from"./ClassedSizeSlider/ClassedSizeSliderViewModel.js";var b;const f="esri-classed-size-slider",g="esri-classed-size-slider__ramp",w="esri-classed-size-slider__slider-container",k="esri-classed-size-slider__histogram-container",v="esri-widget",y="esri-widget--panel",j="esri-disabled",z={trackFillColor:new a([149,149,149]),trackBackgroundColor:new a([224,224,224])};let S=b=class extends u{constructor(e,s){super(e,s),this._rampNode=null,this.breaks=null,this.label=void 0,this.messages=null,this.style={...z},this.viewModel=new h}castStyle(e){return{...z,...e}}static fromRendererResult(e,s){const{renderer:{classBreakInfos:r}}=e,t=r.map((e=>{const s=e.symbol;let r;switch(s.type){case"simple-line":r=s.width;break;case"simple-marker":r=s.size;break;case"picture-marker":r=s.height}return{min:e.minValue,max:e.maxValue,size:r}}));return new b({breaks:t,histogramConfig:{bins:s?s.bins:[]}})}updateClassBreakInfos(e){const s=this.breaks;if(s.length===e.length)return e.map(((e,r)=>{const t=e.symbol;switch(t.type){case"simple-line":t.width=s[r].size;break;case"simple-marker":t.size=s[r].size;break;case"picture-marker":{const e=s[r].size,i=t.width,o=t.height;t.height=e,t.width=e/o*i;break}}return new l({minValue:s[r].min,maxValue:s[r].max,symbol:t})}));console.error(`Number of input breakInfos must match number of slider breaks: ${s.length}`)}updateFromRendererResult(e,s){const{renderer:{classBreakInfos:r}}=e,t=r.map((e=>{const s=e.symbol;let r;switch(s.type){case"simple-line":r=s.width;break;case"simple-marker":r=s.size;break;case"picture-marker":r=s.height}return{min:e.minValue,max:e.maxValue,size:r}}));this.set({breaks:t}),null!=s&&s.bins&&(this.histogramConfig.bins=s.bins)}render(){const{state:e,label:s}=this,r="disabled"===e,t=this.classes(f,v,y,{[j]:r});return p("div",{"aria-label":s,class:t},r?null:this.renderContent(this.renderRamp(),w,k))}renderRamp(){const{style:{trackBackgroundColor:e}}=this;return p("div",{afterCreate:n,bind:this,class:g,"data-node-ref":"_rampNode"},p("svg",{xmlns:"http://www.w3.org/2000/svg"},p("rect",{x:"0",y:"0",fill:c(e),height:"100%",width:"100%"}),this.renderPath()))}renderPath(){if(!this._rampNode)return;const{offsetHeight:e=0,offsetWidth:r=0}=this._rampNode;if(!s(e)||!s(r))return;const{breaks:t,viewModel:{max:i,min:o},style:{trackFillColor:a}}=this,l=i-o,n=r/t.length,m=t.map((s=>e-Math.round((s.min-o)/l*e)+1)).reverse(),d=t[0].size>t[t.length-1].size||!1;let u=d?n:r,h=`M${u} 0 `;return m.forEach(((e,s)=>{const t=n*(s+1);h+=`L${u} ${e} `,u=d?n+t:r-t,h+=`L${u} ${e} `})),h+=`L0 ${e} L0 ${e} L0 0 Z`,p("path",{d:h,fill:c(a)})}};e([t("viewModel.breaks")],S.prototype,"breaks",void 0),e([r({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],S.prototype,"label",void 0),e([r(),d(),m("esri/widgets/smartMapping/ClassedSizeSlider/t9n/ClassedSizeSlider")],S.prototype,"messages",void 0),e([r(),d()],S.prototype,"style",void 0),e([i("style")],S.prototype,"castStyle",null),e([r(),d(["viewModel.hasTimeData","viewModel.inputFormatFunction","viewModel.inputParseFunction","viewModel.labelFormatFunction","viewModel.max","viewModel.min","viewModel.values"])],S.prototype,"viewModel",void 0),S=b=e([o("esri.widgets.smartMapping.ClassedSizeSlider")],S);var M=S;export default M;
