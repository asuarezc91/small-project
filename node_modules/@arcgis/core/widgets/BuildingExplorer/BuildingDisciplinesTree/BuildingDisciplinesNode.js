/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../../../chunks/tslib.es6.js";import"../../../core/has.js";import"../../../core/Logger.js";import"../../../core/accessorSupport/ensureType.js";import{property as s}from"../../../core/accessorSupport/decorators/property.js";import{subclass as i}from"../../../core/accessorSupport/decorators/subclass.js";import"../../../core/urlUtils.js";import"../../../core/uuid.js";import"../../../portal/support/resourceExtension.js";import{on as o}from"../../../core/watchUtils.js";import{isRTL as t}from"../../support/widgetUtils.js";import{renderable as l}from"../../support/decorators/renderable.js";import{j as r}from"../../../chunks/index.js";import a from"../../Widget.js";import{LayerTreeNode as d}from"../support/LayerTreeNode.js";var n;const c={expand:"expand",collapse:"collapse",hideSublayer:"hideSublayer",showSublayer:"showSublayer"},h="esri-building-disciplines-tree-node",g={base:`${h}`,root:`${h}--root`,leaf:`${h}--leaf`,label:`${h}__label`,checkbox:`${h}__checkbox`,checkboxChecked:`${h}__checkbox--checked esri-icon-check-mark`,checkboxIndeterminate:`${h}__checkbox--indeterminate esri-icon-minus`,collapseToggle:`${h}__collapse-toggle esri-icon-right`,collapseToggleCollapsed:`${h}__collapse-toggle--collapsed`,children:`${h}__children`,level:e=>`${h}--level-${e}`};let p=n=class extends a{constructor(e){super(e),this.messages=c,this.toggleSiblingsVisibility=!1,this._childWidgets=[],this._updateChildWidgets=()=>{this._destroyChildWidgets(),this._childWidgets=this.node.children.toArray().reverse().map((e=>new n({node:e,messages:this.messages,toggleSiblingsVisibility:this.toggleSiblingsVisibility})))}}initialize(){this.own(o(this,"node.children","after-changes",this._updateChildWidgets,this._updateChildWidgets,this._updateChildWidgets),this.watch(["messages","toggleSiblingsVisibility"],this._updateChildWidgets))}destroy(){this._destroyChildWidgets()}render(){const e=this.node,s=e.isRoot,i=e.isLeaf;return e.isDiscipline&&i?[]:r("div",{key:e.id,class:this.classes(g.base,g.level(e.level),{[g.root]:s,[g.leaf]:i}),bind:this,onkeydown:this._onKeydown,tabIndex:i?null:0,role:"treeitem","aria-expanded":e.collapsed?"false":"true"},r("label",{bind:this,class:g.label,onclick:this._onCheckboxToggle},this._renderCollapseToggle(),this._renderCheckbox(),r("span",null,e.title)),this._renderChildren(e))}_renderCheckbox(){var e,s;const i=this.node.visible,o=!0===i,t=null===i,l=o?null==(e=this.messages)?void 0:e.hideSublayer:null==(s=this.messages)?void 0:s.showSublayer;return r("button",{bind:this,class:this.classes(g.checkbox,{[g.checkboxChecked]:o,[g.checkboxIndeterminate]:t}),onclick:this._onCheckboxToggle,role:"checkbox","aria-checked":o?"true":"false","aria-label":l,title:l,type:"button"})}_renderCollapseToggle(){var e,s;if(!this.node.hasChildren)return[];const i=this.node.collapsed,o=i?null==(e=this.messages)?void 0:e.expand:null==(s=this.messages)?void 0:s.collapse;return r("div",{bind:this,class:this.classes(g.collapseToggle,{[g.collapseToggleCollapsed]:i}),onclick:this._onCollapseToggle,"aria-label":o,title:o})}_renderChildren(e){return!e.hasChildren||e.collapsed?[]:r("div",{class:g.children},this._childWidgets.map((e=>e.render())))}_onKeydown(e){switch(e.key){case"Space":case"Enter":if(!e.target.classList.contains(g.base))return;e.stopPropagation(),this.node.toggleVisibility();break;case"ArrowLeft":e.stopPropagation(),this.node.toggleCollapsed(!t());break;case"ArrowRight":e.stopPropagation(),this.node.toggleCollapsed(!!t())}}_onCheckboxToggle(e){e.preventDefault(),e.stopPropagation();(e.metaKey||e.ctrlKey)&&this.toggleSiblingsVisibility?this.node.toggleAllSiblingsVisibility():this.node.toggleVisibility()}_onCollapseToggle(e){e.preventDefault(),e.stopPropagation(),this.node.toggleCollapsed()}_destroyChildWidgets(){this._childWidgets.forEach((e=>e.destroy())),this._childWidgets=[]}};e([s({type:d}),l(["node.hasChildren","node.isDiscipline","node.level","node.title","node.visible"])],p.prototype,"node",void 0),e([s(),l()],p.prototype,"messages",void 0),e([s({nonNullable:!0})],p.prototype,"toggleSiblingsVisibility",void 0),e([s(),l()],p.prototype,"_childWidgets",void 0),p=n=e([i("esri.widgets.BuildingExplorer.BuildingDisciplinesTree.BuildingDisciplinesNode")],p);var b=p;export default b;
