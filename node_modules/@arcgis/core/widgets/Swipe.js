/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import"../core/has.js";import"../core/Logger.js";import"../core/accessorSupport/ensureType.js";import{property as i}from"../core/accessorSupport/decorators/property.js";import{aliasOf as t}from"../core/accessorSupport/decorators/aliasOf.js";import{subclass as r}from"../core/accessorSupport/decorators/subclass.js";import"../core/urlUtils.js";import"../core/uuid.js";import"../portal/support/resourceExtension.js";import{eventKey as o}from"../core/events.js";import"./support/widgetUtils.js";import{messageBundle as n}from"./support/decorators/messageBundle.js";import{renderable as s}from"./support/decorators/renderable.js";import{j as a}from"../chunks/index.js";import l from"./Widget.js";import d from"./Swipe/SwipeViewModel.js";const p="esri-swipe",c="esri-swipe--disabled",v="esri-swipe--vertical",h="esri-swipe--horizontal",u="esri-swipe__container",w="esri-swipe__divider",m="esri-swipe__handle",f="esri-swipe__handle--hidden",g="esri-icon-up-down-arrows",_="esri-swipe__handle-icon",y="esri-icon-drag-horizontal",b="esri-icon-drag-vertical",C="esri-widget",P="esri-disabled",M={handle:!0,divider:!0};let L=class extends l{constructor(e,i){super(e,i),this.direction=null,this.disabled=!1,this.dragLabel=void 0,this.iconClass=g,this.label=void 0,this.leadingLayers=null,this.messages=null,this.position=null,this.trailingLayers=null,this.view=null,this.viewModel=new d,this._pointerOffset=null,this._container=null,this._onContainerPointerDown=this._onContainerPointerDown.bind(this),this._onContainerPointerMove=this._onContainerPointerMove.bind(this),this._onContainerPointerUp=this._onContainerPointerUp.bind(this)}set visibleElements(e){this._set("visibleElements",{...M,...e})}get visibleElements(){return this._get("visibleElements")||M}render(){const{state:e,direction:i}=this.viewModel,t="disabled"===e||this.disabled,r={[P]:t,[c]:t,[v]:"vertical"===i,[h]:"horizontal"===i};return a("div",{class:this.classes(p,C,r)},"disabled"===e?null:this.renderContainer())}renderHandle(){const{direction:e}=this.viewModel,{visibleElements:i}=this,t={[y]:"vertical"===e,[b]:"horizontal"===e},r=this.classes(m,!i.handle&&f);return a("div",{key:"handle",role:"presentation",class:r},a("span",{"aria-hidden":"true",class:this.classes(_,t)}))}renderDivider(){const{visibleElements:e}=this;return e&&e.divider?a("div",{key:"divider",role:"presentation",class:w}):null}renderContent(){return[this.renderDivider(),this.renderHandle()]}renderContainer(){const{disabled:e,dragLabel:i,viewModel:t}=this,{max:r,min:o,direction:n,position:s}=t,l=`${s}%`,d={top:"vertical"===n?l:null,left:"vertical"===n?null:l},p=this.renderContent();return a("div",e?{key:"container",role:"presentation",styles:d,class:u}:{tabIndex:0,key:"container",bind:this,afterCreate:this._afterContainerCreate,onkeydown:this._onContainerKeyDown,"touch-action":"none",role:"slider",title:i,"aria-label":i,"aria-orientation":n,"aria-valuemax":`${r}`,"aria-valuemin":`${o}`,"aria-valuenow":`${s}`,"aria-valuetext":l,styles:d,class:u},p)}_afterContainerCreate(e){this._container=e,e.addEventListener("pointerdown",this._onContainerPointerDown)}_calculatePointerOffset(e){const{direction:i}=this,t=e.target,r=("vertical"===i?t.clientHeight:t.clientWidth)/2,o=t.getBoundingClientRect(),n=e.clientX-o.left,s=e.clientY-o.top;this._pointerOffset="vertical"===i?s-r:n-r}_onContainerPointerDown(e){e.preventDefault(),this._container&&document.activeElement!==this.container&&this._container.focus(),this._calculatePointerOffset(e),document.addEventListener("pointerup",this._onContainerPointerUp),document.addEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerUp(e){e.preventDefault(),document.removeEventListener("pointerup",this._onContainerPointerUp),document.removeEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerMove(e){e.preventDefault();const{_pointerOffset:i,container:t,direction:r}=this,{clientX:o,clientY:n}=e,{top:s,left:a,width:l,height:d}=t.getBoundingClientRect(),p=("vertical"===r?n-s-i:o-a-i)/("vertical"===r?d:l)*100;this.position=p}_getKeyPosition(e){const i=o(e),{position:t}=this,{max:r,min:n,step:s,stepMultiplier:a,direction:l}=this.viewModel,d=s*a;["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"].indexOf(i)>-1&&(e.preventDefault(),e.stopPropagation());if("vertical"===l?"ArrowDown"===i||"ArrowRight"===i:"ArrowUp"===i||"ArrowRight"===i){return t+(e.shiftKey?d:s)}if("vertical"===l?"ArrowUp"===i||"ArrowLeft"===i:"ArrowDown"===i||"ArrowLeft"===i){return t-(e.shiftKey?d:s)}if("Home"===i)return n;if("End"===i)return r;if("vertical"===l?"PageDown"===i:"PageUp"===i)return t+d;return("vertical"===l?"PageUp"===i:"PageDown"===i)?t-d:null}_onContainerKeyDown(e){const i=this._getKeyPosition(e);"number"==typeof i&&(this.position=i)}};e([t("viewModel.direction")],L.prototype,"direction",void 0),e([i(),s()],L.prototype,"disabled",void 0),e([i({aliasOf:{source:"messages.dragLabel",overridable:!0}}),s()],L.prototype,"dragLabel",void 0),e([i()],L.prototype,"iconClass",void 0),e([i({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],L.prototype,"label",void 0),e([t("viewModel.leadingLayers")],L.prototype,"leadingLayers",void 0),e([i(),s(),n("esri/widgets/Swipe/t9n/Swipe")],L.prototype,"messages",void 0),e([t("viewModel.position")],L.prototype,"position",void 0),e([t("viewModel.trailingLayers")],L.prototype,"trailingLayers",void 0),e([t("viewModel.view"),s()],L.prototype,"view",void 0),e([i({type:d}),s(["viewModel.state","viewModel.position","viewModel.direction"])],L.prototype,"viewModel",void 0),e([i(),s()],L.prototype,"visibleElements",null),L=e([r("esri.widgets.Swipe")],L);var j=L;export default j;
