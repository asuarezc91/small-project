/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import"../core/has.js";import"../core/Logger.js";import"../core/accessorSupport/ensureType.js";import{property as t}from"../core/accessorSupport/decorators/property.js";import{aliasOf as i}from"../core/accessorSupport/decorators/aliasOf.js";import{subclass as r}from"../core/accessorSupport/decorators/subclass.js";import"../core/urlUtils.js";import"../core/uuid.js";import"../portal/support/resourceExtension.js";import{on as s}from"../core/watchUtils.js";import"./support/widgetUtils.js";import{accessibleHandler as o}from"./support/decorators/accessibleHandler.js";import{messageBundle as n}from"./support/decorators/messageBundle.js";import{renderable as a}from"./support/decorators/renderable.js";import{j as d}from"../chunks/index.js";import p from"./Widget.js";import c from"./Attribution/AttributionViewModel.js";const l="esri-attribution esri-widget",u="esri-widget__anchor",h="esri-attribution__powered-by",m="esri-attribution__sources",_="esri-attribution--open",v="esri-attribution__sources--open",b="esri-attribution__link",w="esri-icon-description",g="esri-interactive";let f=class extends p{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this.iconClass=w,this.itemDelimiter=" | ",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new c}initialize(){this.own(s(this,"viewModel.items","change",(()=>this.scheduleRender())))}get attributionText(){return this.viewModel.items.reduce(((e,t)=>(-1===e.indexOf(t.text)&&e.push(t.text),e)),[]).join(this.itemDelimiter)}render(){const e={[_]:this._isOpen};return d("div",{bind:this,class:this.classes(l,e),onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return d("div",{class:h},"Powered by"," ",d("a",{class:this.classes(b,u),href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive(),i=t?0:-1,{attributionText:r}=this,s=t?"button":void 0,o={[v]:e,[g]:t};return d("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes(m,o),innerHTML:r,role:s,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth}_afterSourcesNodeUpdate(e){let t=!1;const{clientHeight:i,clientWidth:r,scrollWidth:s}=e,o=s>=r,n=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,n&&(t=!0),this._isOpen){const e=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,e&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive()&&(this._isOpen=!this._isOpen)}_isInteractive(){return this._isOpen||this._attributionTextOverflowed}};e([t({dependsOn:["viewModel.items.length","itemDelimiter"],readOnly:!0,autoTracked:!1}),a()],f.prototype,"attributionText",null),e([t()],f.prototype,"iconClass",void 0),e([t(),a()],f.prototype,"itemDelimiter",void 0),e([t({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],f.prototype,"label",void 0),e([t(),a(),n("esri/widgets/Attribution/t9n/Attribution")],f.prototype,"messages",void 0),e([i("viewModel.view")],f.prototype,"view",void 0),e([t({type:c}),a(["state","view.size"])],f.prototype,"viewModel",void 0),e([o()],f.prototype,"_toggleState",null),f=e([r("esri.widgets.Attribution")],f);var j=f;export default j;
