/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as o}from"../../../chunks/tslib.es6.js";import"../../../core/has.js";import{isSome as e}from"../../../core/maybe.js";import"../../../core/Logger.js";import"../../../core/accessorSupport/ensureType.js";import{property as t}from"../../../core/accessorSupport/decorators/property.js";import{subclass as r}from"../../../core/accessorSupport/decorators/subclass.js";import"../../../core/urlUtils.js";import"../../../core/uuid.js";import"../../../portal/support/resourceExtension.js";import{eventKey as i}from"../../../core/events.js";import"../../support/widgetUtils.js";import{renderable as s}from"../../support/decorators/renderable.js";import{j as n}from"../../../chunks/index.js";import{SliderWithDropdownViewModel as l}from"./SliderWithDropdownViewModel.js";import d from"../../Slider.js";const p="esri-interactive",a="esri-slider__label",c="esri-slider-with-dropdown__box",h="esri-slider-with-dropdown__dropdown-root",w=" esri-widget__anchor esri-slider-with-dropdown__anchor",u="esri-slider-with-dropdown__anchor--open",m="esri-slider-with-dropdown__anchor--closed",_="esri-slider-with-dropdown__list",b="esri-slider-with-dropdown__list-item",v="esri-slider-with-dropdown__list-item--selected",D="esri-slider-with-dropdown__box--drop-down-on",f="esri-slider-with-dropdown__box--drop-down-off",x="Enter",y="Escape",j="ArrowUp",g="ArrowDown";let k=class extends d{constructor(o,e){super(o,e),this.viewModel=new l,this.buttonTooltip="",this.showDropDown=!0,this.currentIndex=0,this._rootNode=null}renderThumbLabel(o){const e={[D]:this.showDropDown,[f]:!this.showDropDown};return n("div",{class:this.classes(c,a,e)},super.renderThumbLabel(o),this.showDropDown?n("div",{bind:this,afterCreate:this._onRootNodeCreate,class:h},n("button",{class:this.classes(p,w,this.isDropdownOpen?u:m),bind:this,onclick:this._onAnchorClick,onpointerdown:this._killEvent,"aria-label":this.buttonTooltip,title:this.buttonTooltip,"aria-expanded":this.isDropdownOpen,"aria-haspopup":"listbox",type:"button"},this.currentItem?this.currentItem.name+" ":""),this.isDropdownOpen?n("ol",{class:this.classes(_),onpointerdown:this._killEvent,onblur:this._onDropdownBlur,bind:this,tabindex:"-1","aria-label":this.buttonTooltip,role:"listbox",onkeydown:this._onOlKeyDown,afterCreate:this._focusOnSelectedItem},this.items.map(((o,e)=>n("li",{class:e===this.currentIndex?this.classes(p,b,v):this.classes(p,b),bind:this,onclick:this._onDropdownItemClick,"data-result":e,"aria-label":o.label.join(" "),role:"option","aria-selected":e===this.currentIndex,onkeydown:this._onLiKeyDown,onblur:this._onDropdownBlur,tabindex:"0"},o.label.map((o=>n("span",{bind:this},o))))))):null):null)}_onRootNodeCreate(o){this._rootNode=o}_focusOnSelectedItem(o){var t;const r=null!=(t=o.querySelector(`.${v}`))?t:o.firstChild;e(r)&&r instanceof HTMLElement&&(r.scrollIntoView(),r.focus())}_onAnchorClick(){return this.viewModel.toggle(),!0}_onDropdownItemClick(o){const e=o.currentTarget;this.viewModel.selectItem(e["data-result"])}_onDropdownBlur(o){let t=o.relatedTarget;null===t&&(t=document.activeElement),e(this._rootNode)&&!this._rootNode.contains(t)&&t!==this._rootNode.parentElement&&t!==this._rootNode.parentElement.parentElement&&(this.viewModel.isDropdownOpen=!1)}_killEvent(o){return o.stopPropagation(),!0}_onOlKeyDown(o){event.stopPropagation(),i(o)===y&&(this.viewModel.isDropdownOpen=!1)}_onLiKeyDown(o){const e=event.target;switch(i(o)){case j:if(e.previousElementSibling){e.previousElementSibling.focus()}break;case g:if(e.nextElementSibling){e.nextElementSibling.focus()}break;case x:e.click()}}};o([t(),s()],k.prototype,"viewModel",void 0),o([t(),s()],k.prototype,"buttonTooltip",void 0),o([t(),s()],k.prototype,"showDropDown",void 0),o([t({aliasOf:"viewModel.items"}),s()],k.prototype,"items",void 0),o([t({aliasOf:"viewModel.currentIndex"}),s()],k.prototype,"currentIndex",void 0),o([t({aliasOf:"viewModel.currentItem"}),s()],k.prototype,"currentItem",void 0),o([t({aliasOf:"viewModel.isDropdownOpen"}),s()],k.prototype,"isDropdownOpen",void 0),k=o([r("esri.widgets.Daylight.SliderWithDropdown")],k);var E=k;export default E;
