/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import"../core/has.js";import"../core/Logger.js";import{property as i}from"../core/accessorSupport/decorators/property.js";import{aliasOf as s}from"../core/accessorSupport/decorators/aliasOf.js";import{cast as t}from"../core/accessorSupport/decorators/cast.js";import{subclass as r}from"../core/accessorSupport/decorators/subclass.js";import"../core/urlUtils.js";import"../core/uuid.js";import"../portal/support/resourceExtension.js";import l from"../core/Handles.js";import{init as o}from"../core/watchUtils.js";import"./support/widgetUtils.js";import{messageBundle as n}from"./support/decorators/messageBundle.js";import{renderable as a}from"./support/decorators/renderable.js";import{j as d}from"../chunks/index.js";import c from"./Widget.js";import p from"./BuildingExplorer/BuildingExplorerViewModel.js";import h from"./BuildingExplorer/BuildingDisciplinesTree/BuildingDisciplinesTree.js";import g from"./BuildingExplorer/BuildingLevelPicker/BuildingLevelPicker.js";import v from"./BuildingExplorer/BuildingPhasePicker/BuildingPhasePicker.js";const m={levels:!0,phases:!0,disciplines:!0},u="esri-building-explorer",_={esriWidget:"esri-widget",esriWidgetDisabled:"esri-widget--disabled",esriHeading:"esri-widget__heading",esriIconLoadingIndicator:"esri-icon-loading-indicator",esriRotating:"esri-rotating",widgetIcon:"esri-icon-organization",base:`${u} esri-widget--panel`,panelError:`${u}__panel--error`,loadingContainer:`${u}__loading-container`,content:`${u}__content`,section:`${u}__section`,levels:`${u}__levels`,phases:`${u}__phases`,disciplines:`${u}__disciplines`};let w=class extends c{constructor(e,i){super(e,i),this._defaultViewModel=new p,this.viewModel=this._defaultViewModel,this.view=null,this.layers=null,this.visibleElements={...m},this.iconClass=_.widgetIcon,this.label=void 0,this.messages=null,this.messagesCommon=null,this.toggleSiblingsVisibility=!1,this._handles=new l,this._levelPicker=new g,this._phasePicker=new v,this._disciplinesTree=new h}initialize(){this._handles.add([o(this,"viewModel.level",(()=>{this._levelPicker.viewModel=this.viewModel.level})),o(this,"viewModel.phase",(()=>{this._phasePicker.viewModel=this.viewModel.phase})),o(this,"viewModel.disciplines",(()=>{this._disciplinesTree.viewModel=this.viewModel.disciplines})),o(this,"messages",(()=>{var e,i,s;this._levelPicker.messages=null==(e=this.messages)?void 0:e.level,this._phasePicker.messages=null==(i=this.messages)?void 0:i.phase,this._disciplinesTree.messages=null==(s=this.messages)?void 0:s.disciplines})),o(this,"toggleSiblingsVisibility",(()=>{this._disciplinesTree.toggleSiblingsVisibility=this.toggleSiblingsVisibility}))])}destroy(){this._handles.destroy(),this._levelPicker.destroy(),this._phasePicker.destroy(),this._disciplinesTree.destroy(),this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy()}_castVisibleElements(e){return{...m,...e}}render(){const e="disabled"===this.viewModel.state||!this.viewModel.isSupported;return d("div",{key:this,class:this.classes(_.esriWidget,_.base,{[_.esriWidgetDisabled]:e}),"aria-label":this.messages.widgetLabel},this._renderContent())}_renderContent(){if(!this.viewModel.isSupported)return d("p",{class:_.panelError},this.messages.unsupported);if(!this.viewModel.layers.length)return d("p",{class:_.panelError},this.messages.noData);switch(this.viewModel.state){case"loading":return this._renderLoadingIndicator();case"ready":return d("div",{key:"content",class:_.content},this._renderLevelPickerSection(),this._renderPhasePickerSection(),this._renderDisciplinesSection());case"failed":return d("p",{class:_.panelError},this.messages.failed);default:return null}}_renderLoadingIndicator(){return d("div",{key:"loading-container",role:"presentation",class:_.loadingContainer,"aria-label":this.messagesCommon.loading,title:this.messagesCommon.loading},d("span",{"aria-hidden":"true",class:this.classes(_.esriIconLoadingIndicator,_.esriRotating)}))}_renderLevelPickerSection(){const e=this.viewModel.level,i="ready"===e.state,s=e.allowedValues.length>1;return this.visibleElements.levels&&i&&s?d("div",{key:"levels",class:this.classes(_.section,_.levels)},d("h4",{class:_.esriHeading},this.messages.level.title),this._levelPicker.render()):[]}_renderPhasePickerSection(){const e=this.viewModel.phase,i="ready"===e.state,s=e.allowedValues.length>1;return this.visibleElements.phases&&i&&s?d("div",{key:"phases",class:this.classes(_.section,_.phases)},d("h4",{class:_.esriHeading},this.messages.phase.title),this._phasePicker.render()):[]}_renderDisciplinesSection(){const e=this.viewModel.disciplines,i="ready"===e.state,s=e.root.hasChildren;return this.visibleElements.disciplines&&i&&s?d("div",{key:"disciplines",class:this.classes(_.section,_.disciplines)},d("h4",{class:_.esriHeading},this.messages.disciplines.title),this._disciplinesTree.render()):[]}};e([i({type:p}),a(["state","level.state","phase.state","disciplines.state"])],w.prototype,"viewModel",void 0),e([s("viewModel.view"),a()],w.prototype,"view",void 0),e([s("viewModel.layers")],w.prototype,"layers",void 0),e([i(),a()],w.prototype,"visibleElements",void 0),e([t("visibleElements")],w.prototype,"_castVisibleElements",null),e([i()],w.prototype,"iconClass",void 0),e([s("messages.widgetLabel",{overridable:!0})],w.prototype,"label",void 0),e([i(),a(),n("esri/widgets/BuildingExplorer/t9n/BuildingExplorer")],w.prototype,"messages",void 0),e([i(),a(),n("esri/t9n/common")],w.prototype,"messagesCommon",void 0),e([i({nonNullable:!0}),a()],w.prototype,"toggleSiblingsVisibility",void 0),e([i(),a()],w.prototype,"_levelPicker",void 0),e([i(),a()],w.prototype,"_phasePicker",void 0),e([i(),a()],w.prototype,"_disciplinesTree",void 0),w=e([r("esri.widgets.BuildingExplorer")],w);var y=w;export default y;
