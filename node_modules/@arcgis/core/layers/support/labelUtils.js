/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{replace as e}from"../../core/string.js";const n=new RegExp("__begin__","ig"),r=new RegExp("__end__","ig"),s=new RegExp("^__begin__","i"),t=new RegExp("__end__$","i");function o(e){return e.replace(new RegExp("\\[","g"),"{").replace(new RegExp("\\]","g"),"}")}function i(e){return e.replace(new RegExp("\\{","g"),"[").replace(new RegExp("\\}","g"),"]")}function l(e){const n={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(n.expression=e.labelExpressionInfo.value,n.type="conventional"):e.labelExpressionInfo.expression&&(n.expression=e.labelExpressionInfo.expression,n.type="arcade"):null!=e.labelExpression&&(n.expression=o(e.labelExpression),n.type="conventional"),n}function a(e){const n=l(e);if(!n)return null;switch(n.type){case"conventional":return p(n.expression);case"arcade":return n.expression}return null}function c(e){const n=l(e);if(!n)return null;switch(n.type){case"conventional":return x(n.expression);case"arcade":return w(n.expression)}return null}function p(o){let i;return o?(i=e(o,(e=>'__begin__$feature["'+e+'"]__end__')),i=s.test(i)?i.replace(s,""):'"'+i,i=t.test(i)?i.replace(t,""):i+'"',i=i.replace(n,'" + ').replace(r,' + "')):i='""',i}const u=/^\s*\{([^}]+)\}\s*$/i;function x(e){const n=e.match(u);return n&&n[1].trim()||null}const f=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,_=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,g=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function w(e){if(!e)return null;let n=f.exec(e)||_.exec(e);return n?n[1]||n[3]:(n=g.exec(e),n?n[2]:null)}export{p as convertTemplatedStringToArcade,l as getLabelExpression,a as getLabelExpressionArcade,c as getLabelExpressionSingleField,w as getSingleFieldArcadeExpression,x as getSingleFieldTemplatedString,o as sqlToTemplateString,i as templateStringToSql};
