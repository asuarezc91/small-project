/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import"../../core/has.js";import{isFloat32Array as e,isFloat64Array as n,toArray as r}from"../../core/typedArrayUtil.js";import{clone as t}from"../../core/lang.js";import{isNone as s}from"../../core/maybe.js";import{fromJSON as a}from"../../geometry/support/jsonUtils.js";import i from"../../Graphic.js";import{makeDehydratedPoint as o}from"./dehydratedFeatures.js";function m(e){return"declaredClass"in e}function u(e){return"declaredClass"in e}function l(e){return"declaredClass"in e}function c(e,n){if(!e)return null;if(l(e))return e;const r=new i({layer:n,sourceLayer:n});return r.visible=e.visible,r.symbol=t(e.symbol),r.attributes=t(e.attributes),r.geometry=f(e.geometry),r}function f(e){return s(e)?null:m(e)?e:a(function(e){const n=e.spatialReference.toJSON();switch(e.type){case"point":{const{x:r,y:t,z:s,m:a}=e;return{x:r,y:t,z:s,m:a,spatialReference:n}}case"polygon":{const{rings:r,hasZ:t,hasM:s}=e;return{rings:h(r),hasZ:t,hasM:s,spatialReference:n}}case"polyline":{const{paths:r,hasZ:t,hasM:s}=e;return{paths:h(r),hasZ:t,hasM:s,spatialReference:n}}case"extent":{const{xmin:r,xmax:t,ymin:s,ymax:a,zmin:i,zmax:o,mmin:m,mmax:u,hasZ:l,hasM:c}=e;return{xmin:r,xmax:t,ymin:s,ymax:a,zmin:i,zmax:o,mmin:m,mmax:u,hasZ:l,hasM:c,spatialReference:n}}case"multipoint":{const{points:r,hasZ:t,hasM:s}=e;return{points:y(r)?p(r):r,hasZ:t,hasM:s,spatialReference:n}}default:return}}(e))}function h(e){return function(e){for(const n of e)if(0!==n.length)return y(n);return!1}(e)?e.map((e=>p(e))):e}function p(e){return e.map((e=>r(e)))}function y(r){return r.length&&(e(r[0])||n(r[0]))}function x(e,n){if(!e)return null;let r;if(u(e)){if(null==n)return e.clone();if(u(n))return n.copy(e)}return null!=n?(r=n,r.x=e.x,r.y=e.y,r.spatialReference=e.spatialReference,e.hasZ?(r.z=e.z,r.hasZ=e.hasZ):(r.z=null,r.hasZ=!1),e.hasM?(r.m=e.m,r.hasM=!0):(r.m=null,r.hasM=!1)):(r=o(e.x,e.y,e.z,e.spatialReference),e.hasM&&(r.m=e.m,r.hasM=!0)),r}export{x as clonePoint,f as hydrateGeometry,c as hydrateGraphic,m as isHydratedGeometry,l as isHydratedGraphic,u as isHydratedPoint};
