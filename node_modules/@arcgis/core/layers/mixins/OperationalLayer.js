/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import"../../core/has.js";import"../../core/Logger.js";import"../../core/accessorSupport/ensureType.js";import{property as r}from"../../core/accessorSupport/decorators/property.js";import{subclass as t}from"../../core/accessorSupport/decorators/subclass.js";import{writer as i}from"../../core/accessorSupport/decorators/writer.js";import o from"../../core/Error.js";import"../../core/urlUtils.js";import"../../core/uuid.js";import"../../portal/support/resourceExtension.js";import{readLoadable as s}from"../../core/accessorSupport/read.js";import{willPropertyWrite as p}from"../../core/accessorSupport/write.js";import{supportedTypes as a}from"./operationalLayers.js";import{opacity as n}from"../support/commonProperties.js";const l=l=>{let y=class extends l{constructor(){super(...arguments),this.title=null}writeListMode(e,r,t,i){(i&&"ground"===i.layerContainerType||e&&p(this,t,{},i))&&(r[t]=e)}writeOperationalLayerType(e,r,t,i){!e||i&&"tables"===i.layerContainerType||(r.layerType=e)}writeTitle(e,r){r.title=e||"Layer"}read(e,r){r&&(r.layer=this),s(this,e,(r=>super.read(e,r)),r)}write(e,r){if(r&&r.origin){const e=`${r.origin}/${r.layerContainerType||"operational-layers"}`,t=a[e];let i=t&&t[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===e&&(i=!1),!i)return r.messages&&r.messages.push(new o("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${e}'`,{layer:this})),null}const t=super.write(e,{...r,layer:this}),i=!!r&&!!r.messages&&!!r.messages.filter((e=>e instanceof o&&"web-document-write:property-required"===e.name)).length;return!this.url&&i?null:t}beforeSave(){}};return e([r({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],y.prototype,"id",void 0),e([r({json:{write:{ignoreOrigin:!0},origins:{"web-map":{read:!1,write:!1}}}})],y.prototype,"listMode",void 0),e([i("listMode")],y.prototype,"writeListMode",null),e([r({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],y.prototype,"operationalLayerType",void 0),e([i("operationalLayerType")],y.prototype,"writeOperationalLayerType",null),e([r(n)],y.prototype,"opacity",void 0),e([r({type:String,json:{write:{ignoreOrigin:!0,allowNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,allowNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],y.prototype,"title",void 0),e([i("title")],y.prototype,"writeTitle",null),e([r({type:Boolean,json:{name:"visibility",origins:{"web-document":{name:"visibility",default:!0},"portal-item":{name:"visibility",read:{source:["visible","visibility"]}}}}})],y.prototype,"visible",void 0),y=e([t("esri.layers.mixins.OperationalLayer")],y),y};function y(e){return"operationalLayerType"in e}export{l as OperationalLayer,y as isOperationalLayer};
