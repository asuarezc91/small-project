/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{px2pt as e}from"../../core/screenUtils.js";import{getSize as r,getColor as t,getOpacity as n,getRotationAngle as i}from"../../renderers/visualVariables/support/visualVariableUtils.js";function o(o,a){const{graphic:l,renderer:u,symbol:s}=a,y=s.type;if("text"===y||"shield-label-symbol"===y||!("visualVariables"in u)||!u.visualVariables)return;const f=u.getVisualVariablesForType("size"),p=u.getVisualVariablesForType("color"),c=u.getVisualVariablesForType("opacity"),m=u.getVisualVariablesForType("rotation"),g=f&&f[0],d=p&&p[0],b=c&&c[0],h=m&&m[0];if(g){const t="simple-marker"===y?s.style:null,n=r(g,l,{shape:t});null!=n&&("simple-marker"===y?o.size=e(n):"picture-marker"===y?(o.width=e(n),o.height=e(n)):"simple-line"===y?o.width=e(n):o.outline&&(o.outline.width=e(n)))}if(d){const e=t(d,l);(e&&"simple-marker"===y||"simple-line"===y||"simple-fill"===y)&&(o.color=e?e.toJSON():void 0)}if(b){const e=n(b,l);null!=e&&o.color&&(o.color[3]=Math.round(255*e))}h&&(o.angle=-i(u,l))}function a(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}}function l(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}}function u(){return{layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}}function s(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}}function y(e,r=15){const t=e.canvas.width,n=e.canvas.height,i=e.getImageData(0,0,t,n).data;let o,a,l,u,s,y;e:for(a=n;a--;)for(o=t;o--;)if(i[4*(t*a+o)+3]>r){y=a;break e}if(!y)return null;e:for(o=t;o--;)for(a=y+1;a--;)if(i[4*(t*a+o)+3]>r){s=o;break e}e:for(o=0;o<=s;++o)for(a=y+1;a--;)if(i[4*(t*a+o)+3]>r){l=o;break e}e:for(a=0;a<=y;++a)for(o=l;o<=s;++o)if(i[4*(t*a+o)+3]>r){u=a;break e}return{x:l,y:u,width:s-l,height:y-u}}function f(e,r){const t=e.allLayerViews.items;if(r===e.scale)return t.filter((e=>!e.suspended));const n=new Array;for(const e of t)h(e.parent)&&!n.includes(e.parent)||!e.visible||r&&"isVisibleAtScale"in e&&!e.isVisibleAtScale(r)||n.push(e);return n}function p(e){return e&&"bing-maps"===e.type}function c(e){return e&&"csv"===e.type}function m(e){return e&&"feature"===e.type}function g(e){return e&&"geojson"===e.type}function d(e){return e&&"graphics"===e.type}function b(e){return e&&"group"===e.type}function h(e){return e&&"esri.views.2d.layers.GroupLayerView2D"===e.declaredClass}function w(e){return e&&"imagery"===e.type}function V(e){return e&&"kml"===e.type}function T(e){return e&&"map-image"===e.type}function v(e){return e&&"map-notes"===e.type}function k(e){return e&&"open-street-map"===e.type}function G(e){return e&&"stream"===e.type}function S(e){return e&&"tile"===e.type}function D(e){return e&&"vector-tile"===e.type}function L(e){return e&&"web-tile"===e.type}function P(e){return e&&"wms"===e.type}function I(e){return e&&"wmts"===e.type}export{o as applyVisualVariables,a as createMultipointLayer,u as createPointLayer,l as createPolygonLayer,s as createPolylineLayer,y as getContextBoundingBox,f as getVisibleLayerViews,p as isBingMapsLayer,c as isCSVLayer,m as isFeatureLayer,g as isGeoJSONLayer,d as isGraphicsLayer,b as isGroupLayer,w as isImageryLayer,V as isKMLLayer,T as isMapImageLayer,v as isMapNotesLayer,k as isOpenStreetMapLayer,G as isStreamLayer,S as isTileLayer,D as isVectorTileLayer,P as isWMSLayer,I as isWMTSLayer,L as isWebTileLayer};
