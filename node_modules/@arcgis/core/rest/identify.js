/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import t from"../request.js";import{normalizeCentralMeridian as r}from"../geometry/support/normalizeUtils.js";import{parseUrl as s,encode as o,asValidOptions as e}from"./utils.js";import{identifyToIdentifyRESTParameters as n}from"../tasks/operations/identify.js";import m from"../tasks/support/IdentifyParameters.js";import i from"../tasks/support/IdentifyResult.js";async function u(i,u,f){const a=(u=function(t){return t=m.from(t)}(u)).geometry?[u.geometry]:[],y=s(i);return y.path+="/identify",r(a).then((r=>{const s=n(u,{geometry:r&&r[0]}),m=o({...y.query,f:"json",...s}),i=e(m,f);return t(y.path,i).then(p)}))}function p(t){const r=t.data;r.results=r.results||[];const s={results:[]};return s.results=r.results.map((t=>i.fromJSON(t))),s}export{u as identify};
