/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{c as i,f as t}from"../../../../chunks/vec3f64.js";import{p as n,g as r,a as s,b as o}from"../../../../chunks/vec3.js";import{combineLights as e}from"./SphericalHarmonics.js";const h=i();class g{constructor(){this._renderLighting={main:{intensity:i(),direction:t(1,0,0),castShadows:!1},sphericalHarmonics:{sh:{r:[0],g:[0],b:[0]}}},this._shOrder=2,this._oldSunlight={direction:i(),ambient:{color:i(),intensity:0},diffuse:{color:i(),intensity:0}}}setLightDirectionUniform(i){i.setUniform3fv("lightingMainDirection",this._renderLighting.main.direction)}setUniforms(i,t=!1){if(t){const t=(1-this._info.groundLightingFactor)*(1-this._info.globalFactor);i.setUniform1f("lightingFixedFactor",t)}else i.setUniform1f("lightingFixedFactor",0);i.setUniform1f("lightingGlobalFactor",this._info.globalFactor),this.setLightDirectionUniform(i),i.setUniform3fv("lightingMainIntensity",this._renderLighting.main.intensity),i.setUniform1f("ambientBoostFactor",.4);const n=this._renderLighting.sphericalHarmonics.sh;0===this._shOrder?i.setUniform3f("lightingAmbientSH0",n.r[0],n.g[0],n.b[0]):1===this._shOrder?(i.setUniform4f("lightingAmbientSH_R",n.r[0],n.r[1],n.r[2],n.r[3]),i.setUniform4f("lightingAmbientSH_G",n.g[0],n.g[1],n.g[2],n.g[3]),i.setUniform4f("lightingAmbientSH_B",n.b[0],n.b[1],n.b[2],n.b[3])):2===this._shOrder&&(i.setUniform3f("lightingAmbientSH0",n.r[0],n.g[0],n.b[0]),i.setUniform4f("lightingAmbientSH_R1",n.r[1],n.r[2],n.r[3],n.r[4]),i.setUniform4f("lightingAmbientSH_G1",n.g[1],n.g[2],n.g[3],n.g[4]),i.setUniform4f("lightingAmbientSH_B1",n.b[1],n.b[2],n.b[3],n.b[4]),i.setUniform4f("lightingAmbientSH_R2",n.r[5],n.r[6],n.r[7],n.r[8]),i.setUniform4f("lightingAmbientSH_G2",n.g[5],n.g[6],n.g[7],n.g[8]),i.setUniform4f("lightingAmbientSH_B2",n.b[5],n.b[6],n.b[7],n.b[8]))}set(i){this._info=i,e(i.lights,this._shOrder,this._renderLighting),n(this._oldSunlight.direction,this._renderLighting.main.direction);const t=1/Math.PI;this._oldSunlight.ambient.color[0]=.282095*this._renderLighting.sphericalHarmonics.sh.r[0]*t,this._oldSunlight.ambient.color[1]=.282095*this._renderLighting.sphericalHarmonics.sh.g[0]*t,this._oldSunlight.ambient.color[2]=.282095*this._renderLighting.sphericalHarmonics.sh.b[0]*t,this._oldSunlight.ambient.intensity=1,this._oldSunlight.diffuse.color[0]=this._renderLighting.main.intensity[0]*t,this._oldSunlight.diffuse.color[1]=this._renderLighting.main.intensity[1]*t,this._oldSunlight.diffuse.color[2]=this._renderLighting.main.intensity[2]*t,this._oldSunlight.diffuse.intensity=1;const g=r(h,this._oldSunlight.diffuse.color);s(g,g,.4*this._info.globalFactor),o(this._oldSunlight.ambient.color,this._oldSunlight.ambient.color,g)}get globalFactor(){return this._info.globalFactor}get old(){return this._oldSunlight}}export{g as SceneLighting};
