/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../../../../../chunks/tslib.es6.js";import"../../../../../core/has.js";import"../../../../../core/mathUtils.js";import{ReloadableShaderModule as i}from"../../core/shaderTechnique/ReloadableShaderModule.js";import{ShaderTechnique as r}from"../../core/shaderTechnique/ShaderTechnique.js";import{parameter as o,ShaderTechniqueConfiguration as t}from"../../core/shaderTechnique/ShaderTechniqueConfiguration.js";import a from"../../../../webgl/Program.js";import{makePipelineState as s,separateBlendingParams as l,defaultColorWriteParams as n,defaultDepthWriteParams as c}from"../../../../webgl/renderState.js";import"../../../../webgl/FramebufferObject.js";import"../../../../webgl/RenderingContext.js";import{VertexPosition as m}from"../../core/shaderLibrary/attributes/VertexPosition.glsl.js";import{E as d}from"../../../../../chunks/EdgeShaderProgram.glsl.js";class u extends r{bindPass(e,i){const r=this.program,{edgeRenderParameters:o,bindParameters:t}=i;m.bindViewProjTransform(r,o.viewProjectionTransform),r.setUniformMatrix3fv("uTransformNormal_ViewFromGlobal",o.transformNormal_ViewFromGlobal),r.setUniformMatrix4fv("uProj",t.camera.projectionMatrix),r.setUniform2f("uDepthBias",.5,-4e-4),r.setUniform2f("uPixelToNDC",2/t.camera.fullViewport[2],2/t.camera.fullViewport[3]),r.setUniform2f("uNDCToPixel",t.camera.fullViewport[2]/2,t.camera.fullViewport[3]/2),r.setUniform1f("uDistanceFalloffFactor",o.distanceFalloffFactor),r.setUniform2f("uViewportDimInv",1/t.camera.fullViewport[2],1/t.camera.fullViewport[3]),r.setUniform1f("uPixelRatio",t.camera.pixelRatio||1)}initializeProgram(e){const i=u.shader.get(),r=this.configuration,o=i.build({slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:r.sliceHighlightDisabled,sliceEnabledForVertexPrograms:!1,silhouette:r.silhouette,legacy:r.legacy,antialiasing:r.antialiasing,mode:r.mode,doublePrecisionRequiresObfuscation:r.doublePrecisionRequiresObfuscation});return new a(e.rctx,o.generateSource("vertex"),o.generateSource("fragment"),i.attributeLocations)}initializePipeline(e){const i=e.rctx.capabilities.blendMinMax;return s(i?{blending:l(1,1,0,1,32774,i.MAX),depthTest:{func:515},colorWrite:n}:{depthTest:{func:515},depthWrite:c,colorWrite:n})}}u.shader=new i(d,(()=>import("../../shaders/sources/edgeRenderer/EdgeShaderProgram.glsl.js"))),function(i){class r extends t{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.sliceHighlightDisabled=!1,this.silhouette=!1,this.legacy=!1,this.antialiasing=!1,this.mode=0,this.doublePrecisionRequiresObfuscation=!1}}e([o()],r.prototype,"slicePlaneEnabled",void 0),e([o()],r.prototype,"sliceHighlightDisabled",void 0),e([o()],r.prototype,"silhouette",void 0),e([o()],r.prototype,"legacy",void 0),e([o()],r.prototype,"antialiasing",void 0),e([o({count:3})],r.prototype,"mode",void 0),e([o()],r.prototype,"doublePrecisionRequiresObfuscation",void 0),i.Configuration=r}(u||(u={}));export{u as EdgeShaderTechnique};
