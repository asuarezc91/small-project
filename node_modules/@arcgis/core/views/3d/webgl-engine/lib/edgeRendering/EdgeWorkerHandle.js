/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{isUint32Array as e}from"../../../../../core/typedArrayUtil.js";import{WorkerHandle as r}from"../../../support/WorkerHandle.js";import{unpackInterleavedBuffer as t}from"../../../support/buffer/workerHelper.js";import{work as n}from"./EdgeProcessingWorker.js";export default class extends r{constructor(e){super("EdgeProcessingWorker","wrappedWork",e)}async process(e,r,t){if(t)return n(e);const a=this._packInput(e),s=await this.invoke(a,r);return this._unpackOutput(s)}getTransferList(e){return[e.dataBuffer]}_packInput(r){const t={dataBuffer:r.data.buffer,writerSettings:r.writerSettings,skipDeduplicate:r.skipDeduplicate};return r.originalIndices&&(t.originalIndicesBuffer=r.originalIndices.buffer,t.originalIndicesType=e(r.originalIndices)?"Uint32Array":"Uint16Array"),t}_unpackOutput(e){return{regular:{instancesData:t(e.regular.instancesData),lodInfo:{lengths:new Float32Array(e.regular.lodInfo.lengths)}},silhouette:{instancesData:t(e.silhouette.instancesData),lodInfo:{lengths:new Float32Array(e.silhouette.lodInfo.lengths)}},averageEdgeLength:e.averageEdgeLength}}}
