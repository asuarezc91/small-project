/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../../../../../chunks/tslib.es6.js";import"../../../../../core/has.js";import{unwrapOr as t}from"../../../../../core/maybe.js";import"../../../../../core/Logger.js";import"../../../../../core/accessorSupport/ensureType.js";import{property as o}from"../../../../../core/accessorSupport/decorators/property.js";import{subclass as r}from"../../../../../core/accessorSupport/decorators/subclass.js";import"../../../../../core/urlUtils.js";import"../../../../../core/uuid.js";import"../../../../../portal/support/resourceExtension.js";import i from"../../../../../core/Evented.js";import{SceneDrawSurface as n}from"./drawSurfaces.js";import{DrawOperation as s}from"./DrawOperation.js";import{InteractiveToolBase as a}from"../../../../interactive/InteractiveToolBase.js";import{SnappingOptions as p}from"../../../../interactive/snapping/SnappingOptions.js";let d=class extends(i.EventedMixin(a)){constructor(e){super(e),this.drawOperation=null,this.hasZ=!0,this.defaultZ=0,this.elevationInfo=null,this.snapToScene=null,this.snappingOptions=new p,this.mode=null,this.geometryType=null,this.type="draw-3d"}initialize(){const e=t(this.elevationInfo,{mode:this.hasZ?"absolute-height":"on-the-ground",offset:0});this.drawOperation=new s({view:this.view,manipulators:this.manipulators,geometryType:this.geometryType,drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,snappingDrawSurface:new n(this.view,e),hasM:!1,elevationInfo:e,snappingOptions:this.snappingOptions}),this.drawOperation.on("vertex-add",(e=>this.onVertexAdd(e))),this.drawOperation.on("vertex-remove",(e=>this.onVertexRemove(e))),this.drawOperation.on("vertex-update",(e=>this.onVertexUpdate(e))),this.drawOperation.on("cursor-update",(e=>this.onCursorUpdate(e))),this.drawOperation.on("complete",(e=>this.onComplete(e)))}destroy(){this.drawOperation.destroy(),this.drawOperation=null,this._set("view",null)}onInputEvent(e){this.drawOperation.onInputEvent(e)}set enabled(e){this.drawOperation.interactive=e,this._set("enabled",e)}reset(){}get canRedo(){return this.drawOperation.canRedo}redo(){this.drawOperation.redo()}get canUndo(){return this.drawOperation.canUndo}undo(){this.drawOperation.undo()}completeCreateOperation(){this.drawOperation.complete()}activate(){}deactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}getVertexCoords(){return this.drawOperation.vertices}onVertexAdd(e){this.emit("vertex-add",e)}onVertexRemove(e){this.emit("vertex-remove",e)}onVertexUpdate(e){this.emit("vertex-update",e)}onCursorUpdate(e){this.emit("cursor-update",e)}onComplete(e){this.emit("complete",e)}};e([o({constructOnly:!0,nonNullable:!0})],d.prototype,"view",void 0),e([o({value:!0})],d.prototype,"enabled",null),e([o({constructOnly:!0})],d.prototype,"hasZ",void 0),e([o({constructOnly:!0,nonNullable:!0})],d.prototype,"defaultZ",void 0),e([o({constructOnly:!0})],d.prototype,"elevationInfo",void 0),e([o()],d.prototype,"snapToScene",void 0),e([o({constructOnly:!0})],d.prototype,"snappingOptions",void 0),e([o({constructOnly:!0})],d.prototype,"mode",void 0),e([o({constructOnly:!0})],d.prototype,"geometryType",void 0),e([o({readOnly:!0})],d.prototype,"type",void 0),d=e([r("esri.views.3d.interactive.editingTools.draw.DrawTool")],d);export{d as DrawTool};
