/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{isNone as t}from"../../../../../core/maybe.js";import{cyclical2PI as n}from"../../../support/mathUtils.js";import{empty as e,expandPointInPlace as r,area as o,create as s}from"../../../../../geometry/support/aaBoundingRect.js";import{a}from"../../../../../chunks/vec2f64.js";import{o as c}from"../../../../../chunks/vec2.js";import{convexHull as i}from"../../../../../geometry/geometryEngine.js";import{f as m}from"../../../../../chunks/mat2.js";import{c as f}from"../../../../../chunks/mat2f64.js";import{dragGraphic as p,resetGraphic as l}from"../../../../interactive/dragEventPipeline.js";function u(t,n,e){const r=t.graphic,o=(t,e)=>n({action:t,graphic:r,dxScreen:e.screenDeltaX,dyScreen:e.screenDeltaY});return e(((t,n,e)=>{n.next((t=>("start"===t.action&&o("start",t),t))).next(p(r)).next((t=>{switch(t.action){case"start":case"update":(t.translationX||t.translationY||t.translationZ)&&o("update",t);break;case"end":o("end",t)}return t})),e.next(l(r)).next((()=>{o("end",{screenDeltaX:0,screenDeltaY:0})}))}))}function h(s){if(t(s)||"polyline"!==s.type&&"polygon"!==s.type)return 0;const a=i(s),f=a&&a.rings&&a.rings[0];if(!f)return 0;!function(t){let n=0,e=0;for(const r of t)n+=r[0],e+=r[1];n/=t.length,e/=t.length;for(const r of t)r[0]-=n,r[1]-=e}(f);const p=[];for(let t=0;t<f.length-1;t++){const e=Math.atan2(f[t+1][1]-f[t][1],f[t+1][0]-f[t][0]),r=n.normalize(e)%(Math.PI/2);p.push(r)}const l=p.sort(((t,n)=>t-n));let u=null,h=0,y=Number.POSITIVE_INFINITY,x=0;for(const t of l){if(t===u)continue;u=t,m(g,t),e(d);for(const t of f)c(j,t,g),r(d,j);const n=o(d);((n>y?y/n:n/y)>=.99&&t<h||n<y)&&(h=t,y=n),x=Math.max(x,n)}return y/x>=.95?0:h}const g=f(),d=s(),j=a();export{u as createGraphicMoveDragPipeline,h as primaryShapeOrientation};
