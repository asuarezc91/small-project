/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../../../../../chunks/tslib.es6.js";import"../../../../../core/has.js";import{isNone as t,isSome as i}from"../../../../../core/maybe.js";import"../../../../../core/Logger.js";import"../../../../../core/accessorSupport/ensureType.js";import{property as r}from"../../../../../core/accessorSupport/decorators/property.js";import{subclass as n}from"../../../../../core/accessorSupport/decorators/subclass.js";import"../../../../../core/urlUtils.js";import"../../../../../core/uuid.js";import"../../../../../portal/support/resourceExtension.js";import s from"../../../../../geometry/Point.js";import o from"../../../../../core/Collection.js";import a from"../../../../../Color.js";import{screenPointObjectToArray as l}from"../../../../../core/screenUtils.js";import{c}from"../../../../../chunks/vec3f64.js";import{g as h,d,a as u,n as p,b as _,f as g,w as m,r as v}from"../../../../../chunks/vec3.js";import b from"../../../../../core/Handles.js";import{init as f,on as y,watch as O}from"../../../../../core/watchUtils.js";import{Task as L}from"../../../../support/Scheduler.js";import{a as C}from"../../../../../chunks/mat4f64.js";import{getObjectId as I}from"../../../../../layers/graphics/dehydratedFeatures.js";import{sv2d as T}from"../../../support/stack.js";import{a as w,b as S,i as R,c as M}from"../../../../../chunks/ray.js";import{lineSegment as k}from"../../../support/geometryUtils.js";import E from"../../../webgl-engine/lib/Object3D.js";import{Intersector as V}from"../../../webgl-engine/lib/Intersector.js";import P from"../../../webgl-engine/lib/Layer.js";import{tilesAreRelated as H}from"../../../terrain/tileUtils.js";import{createManipulatorDragEventPipeline as A}from"../../../../interactive/dragEventPipeline.js";import{LaserLineRenderer as G}from"../../../support/LaserLineRenderer.js";import{InteractiveToolBase as j}from"../../../../interactive/InteractiveToolBase.js";import{Configuration as D}from"./lineOfSightToolConfig.js";import{createSphereManipulator as z,createPolylineMaterial as F,createPolylineGeometry as x}from"./lineOfSightToolUtils.js";import N from"../../../../../widgets/LineOfSight/LineOfSightTarget.js";const U=o.ofType(N);let W=class extends j{constructor(e){super(e),this.deferCreation=!0,this.observer=null,this.targets=new U,this.configuration=null,this.updating=!1,this._handles=new b,this._manipulatorHandles=new b,this._observer=null,this._tracker=null,this._analyses=new o,this._screenPixelSize=0,this._grabbedManipulator=null,this._showTracker=!0}initialize(){const e=f(this,"state",(e=>{switch(e){case"created":this.complete();break;default:this.create()}}),!0),t=this.configuration=new D;this._intersector=new V(this.view.state.mode),this._intersector.options.hud=!1,this._intersector.options.store=0,this._engineLayer=new P("line-of-sight-analysis",{isPickable:!1});const i=this.view._stage;i.addToViewContent([this._engineLayer.id]),i.add(0,this._engineLayer),this._createEngineResources(),this._observer={location:null,intersection:null,manipulator:this._addManipulator({size:t.observerManipulatorSize,color:t.observerManipulatorColor,visible:!1})},this._tracker=this._createLineOfSightAnalysis(new N({location:new s})),this._tracker.point.manipulator.available=!1,this._tracker.point.manipulator.interactive=!1;const r=this._handles;r.add([e,this.view.state.watch("camera",(()=>this._onCameraChange())),this.view.watch("map.ground.opacity",((e,t)=>this._onGroundOpacityChange(e,t))),f(this.view,"slicePlane",(()=>this._onSlicePlaneChange())),f(this,"observer",(e=>this._onObserverChange(e)),!0),y(this,"targets","change",(e=>this._onTargetCollectionChange(e)),(e=>this._onTargetsChange(e)),null,!0),O(this.configuration,["laserLineEnabled","laserLineGlowColor","laserLineGlowWidth","laserLineInnerColor","laserLineInnerWidth","laserLineGlobalAlpha","lineOfSightInnerWidth","lineOfSightOuterWidth","lineOfSightVisibleInnerColor","lineOfSightVisibleOuterColor","lineOfSightOccludedInnerColor","lineOfSightOccludedOuterColor","lineOfSightUndefinedInnerColor","lineOfSightUndefinedOuterColor","lineOfSightUndefinedStipplePattern","lineOfSightUndefinedStipplePatternOffColor"],(()=>this._createEngineResources())),O(this.configuration,["observerManipulatorSize","observerManipulatorColor"],(()=>this._recreateManipulator(this._observer))),O(this.configuration,["targetManipulatorSize","targetManipulatorVisibleColor","targetManipulatorOccludedColor","targetManipulatorUndefinedColor"],(()=>this._analyses.forEach((e=>this._recreateManipulator(e.point)))))]);const n=this.view.pointsOfInterest;n&&r.add([n.contentGeometryUpdates.events.on("request-update",(()=>this._onContentChange())),this.view.elevationProvider.on("elevation-change",(()=>this._onContentChange()))]);const o=this.view.resourceController&&this.view.resourceController.scheduler;o&&(this._frameTask=o.registerTask(L.LINE_OF_SIGHT_TOOL,(e=>this._updateAnalyses(e)),(()=>this.updating)),r.add(this._frameTask)),this.continue()}destroy(){this.detach(),this._handles.destroy(),this._handles=null,this._manipulatorHandles.destroy(),this._manipulatorHandles=null,this.manipulators.remove(this._observer.manipulator),this._destroyLineOfSightAnalysis(this._tracker),this._analyses.forEach((e=>{this._destroyLineOfSightAnalysis(e)}));const e=this.view._stage;e.removeFromViewContent([this._engineLayer.id]),e.remove(0,this._engineLayer.id),this._removeEngineResources(),this._engineLayer=null,e.removeRenderPlugin(this._engineResources.laserLineRenderer),this._engineResources.laserLineRenderer=null,this._engineResources=null,this._intersector=null,this.observer=null,this._set("targets",null)}get state(){return this._showTracker?"creating":this.observer?"created":"ready"}get cursor(){return this.manipulators.some((({manipulator:e})=>e.focused))?null:this._showTracker?"crosshair":null}get isSupported(){return"3d"===this.get("view.type")}continue(){this.view.activeTool=this,this._showTracker=!0,this._updateTrackerVisibility()}stop(){this._showTracker=!1,this._setDirty(L.LINE_OF_SIGHT_TOOL_INTERACTIVE),this._updateTrackerVisibility()}onInputEvent(e){switch(e.type){case"immediate-double-click":this._doubleClickHandler(e);break;case"key-down":this._keyDownHandler(e);break;case"pointer-move":this._pointerMoveHandler(e)}}onInputEventAfter(e){switch(e.type){case"immediate-click":this._clickHandler(e)}}_setDirty(e){this.updating?e===L.LINE_OF_SIGHT_TOOL_INTERACTIVE&&this._frameTask&&(this._frameTask.task=e):(this._set("updating",!0),this._frameTask&&(this._frameTask.task=e))}_updateTrackerVisibility(){this._tracker.shouldRender=this._showTracker&&!this.manipulators.some((e=>e.manipulator.focused)),this._updateLaserLineRenderer()}_manipulatorFocusChanged(){this._updateTrackerVisibility(),this.notifyChange("cursor")}_addManipulator(e){const t=z(this.view,e);return this._manipulatorHandles.add([this._createManipulatorDragPipeline(t),t.events.on("focus-changed",(()=>this._manipulatorFocusChanged())),t.events.on("grab-changed",(e=>this._manipulatorGrabChanged(t,e))),t.events.on("immediate-click",(e=>e.stopPropagation()))],t),this.manipulators.add(t),t}_removeManipulator(e){this.manipulators.remove(e),this._manipulatorHandles.remove(e)}_recreateManipulator(e){const t=this.configuration,i=e.manipulator;this._removeManipulator(i);const r=e===this._observer?{size:t.observerManipulatorSize,color:t.observerManipulatorColor,visible:i.available}:{size:t.targetManipulatorSize,customColor1:t.targetManipulatorVisibleColor,customColor2:t.targetManipulatorOccludedColor,customColor3:t.targetManipulatorUndefinedColor};e.manipulator=this._addManipulator(r),e.manipulator.location=i.location,this._setDirty(L.LINE_OF_SIGHT_TOOL_INTERACTIVE)}_screenToIntersection(){return e=>{const i=this._getScreenPointIntersection(e.screenEnd);return t(i)?null:{...e,intersection:i}}}_createManipulatorDragPipeline(e){return A(e,((t,i,r)=>{i.next(this._screenToIntersection()).next(e===this._observer.manipulator?this._updateObserverDragStep():this._updateAnalysisDragStep(e)).next((()=>this._updateLaserLineRenderer())),r.next(e===this._observer.manipulator?this._cancelObserverDragStep():this._cancelAnalysisDragStep(e)).next((()=>this._updateLaserLineRenderer()))}))}_updateObserverDragStep(){return e=>(this.observer=e.intersection.point,this._observer.intersection=e.intersection,e)}_cancelObserverDragStep(){const e=i(this.observer)?this.observer.clone():null,t=this._observer.intersection;return i=>(this.observer=e,this._observer.intersection=t,i)}_updateAnalysisDragStep(e){return t=>{const i=this._analyses.find((t=>t.point.manipulator===e));return i.target.location=t.intersection.point,i.point.intersection=t.intersection,t}}_cancelAnalysisDragStep(e){const t=this._analyses.find((t=>t.point.manipulator===e)),r=i(t.target.location)?t.target.location.clone():null,n=t.point.intersection;return e=>(t.target.location=r,t.point.intersection=n,e)}_updateLaserLineRenderer(){const e=this._engineResources.laserLineRenderer;if(!this.configuration.laserLineEnabled)return e.heightManifoldEnabled=!1,void(e.lineVerticalPlaneEnabled=!1);const t=i(this._grabbedManipulator)?this._grabbedManipulator:this._tracker.shouldRender&&this.observer?this._tracker.point.manipulator:null;this.configuration.laserLineEnabled&&i(t)?(e.heightManifoldEnabled=!0,e.heightManifoldTarget=t.renderLocation,t!==this._observer.manipulator?(e.lineVerticalPlaneEnabled=!0,e.lineVerticalPlaneSegment=k.fromPoints(this._observer.manipulator.renderLocation,t.renderLocation,Z)):e.lineVerticalPlaneEnabled=!1):(e.heightManifoldEnabled=!1,e.lineVerticalPlaneEnabled=!1)}_createLaserLineRenderer(){const e=this.configuration;return new G(this.view.renderCoordsHelper,{glowColor:a.toUnitRGB(e.laserLineGlowColor),glowWidth:e.laserLineGlowWidth,innerColor:a.toUnitRGB(e.laserLineInnerColor),innerWidth:e.laserLineInnerWidth,globalAlpha:e.laserLineGlobalAlpha})}_removeEngineResources(){const e=this.view._stage;e.remove(3,this._engineResources.visibleLineMaterialInner.id),e.remove(3,this._engineResources.visibleLineMaterialOuter.id),e.remove(3,this._engineResources.occludedLineMaterialInner.id),e.remove(3,this._engineResources.occludedLineMaterialOuter.id),e.remove(3,this._engineResources.undefinedLineMaterialInner.id),e.remove(3,this._engineResources.undefinedLineMaterialOuter.id)}_createEngineResources(){const e=this.view._stage,t=this.configuration;this._engineResources&&(this._removeEngineResources(),e.removeRenderPlugin(this._engineResources.laserLineRenderer)),this._engineResources={laserLineRenderer:this._createLaserLineRenderer(),visibleLineMaterialInner:F(t.lineOfSightInnerWidth,t.lineOfSightVisibleInnerColor),visibleLineMaterialOuter:F(t.lineOfSightOuterWidth,t.lineOfSightVisibleOuterColor),occludedLineMaterialInner:F(t.lineOfSightInnerWidth,t.lineOfSightOccludedInnerColor),occludedLineMaterialOuter:F(t.lineOfSightOuterWidth,t.lineOfSightOccludedOuterColor),undefinedLineMaterialInner:F(t.lineOfSightInnerWidth,t.lineOfSightUndefinedInnerColor),undefinedLineMaterialOuter:F(t.lineOfSightOuterWidth,t.lineOfSightUndefinedOuterColor)},e.addRenderPlugin(this._engineResources.laserLineRenderer.renderSlots,this._engineResources.laserLineRenderer),e.add(3,this._engineResources.visibleLineMaterialInner),e.add(3,this._engineResources.visibleLineMaterialOuter),e.add(3,this._engineResources.occludedLineMaterialInner),e.add(3,this._engineResources.occludedLineMaterialOuter),e.add(3,this._engineResources.undefinedLineMaterialInner),e.add(3,this._engineResources.undefinedLineMaterialOuter),this._setDirty(L.LINE_OF_SIGHT_TOOL_INTERACTIVE)}_onObserverChange(e){if(t(e))return this._observer.manipulator.available=!1,void this.targets.removeAll();this._observer.location=e,this._observer.intersection=null,this._observer.manipulator.available=!0,this._observer.manipulator.location=e,this._tracker.point.manipulator.location=e,this._analyses.forEach((e=>{e.isDirty=!0,e.isValid=!1})),this._setDirty(L.LINE_OF_SIGHT_TOOL_INTERACTIVE)}_onTargetsChange(e){this._analyses.forEach((e=>{this._destroyLineOfSightAnalysis(e)})),this._analyses.removeAll(),e.items&&this._onTargetCollectionChange({target:e,added:e.items,removed:[],moved:[]})}_onTargetCollectionChange(e){e.added.forEach((e=>{if(!this._analyses.some((t=>t.target===e))){const t=this._createLineOfSightAnalysis(e);this._analyses.add(t)}this._setDirty(L.LINE_OF_SIGHT_TOOL_INTERACTIVE)})),e.removed.forEach((e=>{const t=this._analyses.find((t=>t.point.location===e.location));this._destroyLineOfSightAnalysis(t),this._analyses.remove(t)}))}_onTargetLocationChange(e,t){e.isValid=!1,e.point.location=t,e.point.intersection=null,e.point.manipulator.location=t,e.isDirty=!0,this._setDirty(L.LINE_OF_SIGHT_TOOL_INTERACTIVE)}_onGroundOpacityChange(e,t){this._analyses.length&&(1!==e&&1!==t||e===t||(this._setDirty(L.LINE_OF_SIGHT_TOOL),this._analyses.forEach((e=>e.isDirty=!0))))}_onContentChange(){this._analyses.forEach((e=>{e.isDirty=!0,e.shouldIntersect=!0})),this._setDirty(L.LINE_OF_SIGHT_TOOL)}_onCameraChange(){if(!this._analyses.length)return;let e=!1;if(i(this.observer)){this.view.renderCoordsHelper.toRenderCoords(this.observer,$);const t=this.view.state.camera.computeScreenPixelSizeAt($);e=e||Math.abs((t-this._screenPixelSize)/this._screenPixelSize)>.1}this._analyses.some((e=>!e.isValid))&&(e=!0),e&&(this._setDirty(L.LINE_OF_SIGHT_TOOL),this._analyses.forEach((e=>e.isDirty=!0)))}_onSlicePlaneChange(){this._analyses.length&&(this._setDirty(L.LINE_OF_SIGHT_TOOL_INTERACTIVE),this._analyses.forEach((e=>e.isDirty=!0)))}_addPointFromClickEvent(e){const i=this._getScreenPointIntersection(e);if(!t(i)&&!t(i.point))if(this.observer){const e=new N({location:i.point}),t=this._createLineOfSightAnalysis(e);this._analyses.add(t),t.point.intersection=i,this.targets.add(e)}else this.observer=i.point,this._observer.intersection=i}_clickHandler(e){this._showTracker&&(this._addPointFromClickEvent({x:e.x,y:e.y}),e.stopPropagation())}_doubleClickHandler(e){this._showTracker&&(this.stop(),e.stopPropagation())}_keyDownHandler(e){this._showTracker&&"Escape"===e.key&&(this.stop(),e.stopPropagation())}_pointerMoveHandler(e){if(!this._showTracker)return;const t={x:e.x,y:e.y},r=this._getScreenPointIntersection(t);i(r)&&i(r.point)&&(this._tracker.point.manipulator.location=r.point,this._tracker.isDirty=!0,this._updateLaserLineRenderer(),this._setDirty(L.LINE_OF_SIGHT_TOOL_INTERACTIVE))}_getScreenPointIntersection(e){const t=l(e,T.get()),i=w(this.view.state.camera,t,Q);return this._getRayIntersection(i)}_getRayIntersection(e){if(t(e))return null;this.view.sceneIntersectionHelper.intersectToolIntersectorRay(e,this._intersector);const r=this._intersector.results.min;if(!r||!r.getIntersectionPoint($))return null;const n=new s;this.view.renderCoordsHelper.fromRenderCoords($,n,this.view.spatialReference);const o=c();h(o,r.normal);const a=d(o,e.direction)>0?-1:1;u(o,o,a);const l=r.toGraphic(this.view);if(i(l)){const t=l.layer,i=l.sourceLayer;let s;if(i)switch(i.type){case"scene":s=I(l,i.objectIdField);break;case"integrated-mesh":{const e=r.target;s=`${e.metadata.nodeIndex}/${e.metadata.componentIndex}`;break}default:s=l.uid}else s=l.uid;return{type:"Graphic",id:`${t.uid}/${s}`,ray:S(e),normal:o,point:n}}if("TerrainRenderer"===r.intersector){return{type:"Terrain",id:r.target.metadata.tile.lij.slice(),ray:S(e),normal:o,point:n}}return null}_createLineOfSightAnalysis(e){const t=this.configuration,r={isValid:!1,isDirty:!0,shouldRender:!0,shouldIntersect:!1,point:{location:e.location,manipulator:this._addManipulator({size:t.targetManipulatorSize,customColor1:t.targetManipulatorVisibleColor,customColor2:t.targetManipulatorOccludedColor,customColor3:t.targetManipulatorUndefinedColor}),intersection:null},isTargetVisible:!1,hasIntersection:!1,target:e,targetHandle:null,engine:{points:{observer:c(),target:c(),intersection:c(),intersectionObserver:c(),intersectionTarget:c()},visualization:new E}};return i(e.location)&&(r.point.manipulator.location=e.location),r.targetHandle=f(e,"location",(e=>this._onTargetLocationChange(r,e)),!0),this.manipulators.add(r.point.manipulator),this.view._stage.add(1,r.engine.visualization),this._engineLayer.addObject(r.engine.visualization),r}_destroyLineOfSightAnalysis(e){e.targetHandle.remove(),this.manipulators.remove(e.point.manipulator),this.view._stage.remove(1,e.engine.visualization.id),this._engineLayer.removeObject(e.engine.visualization)}_canComputeAnalysis(e){if(t(this.observer)||t(e.point)||t(e.point.location))return!1;this.view.renderCoordsHelper.toRenderCoords(this.observer,$);const i=this.view.frustum.intersectsPoint($);this.view.renderCoordsHelper.toRenderCoords(e.point.location,$);const r=this.view.frustum.intersectsPoint($);return i&&r}_manipulatorGrabChanged(e,t){switch(t.action){case"start":this._grabbedManipulator=e;break;case"end":this._grabbedManipulator===e&&(this._grabbedManipulator=null)}this._updateTrackerVisibility()}_canUpdateFromIntersectionResult(e,i){if(t(e)||!i||e.type!==i.type)return!1;if("Terrain"===e.type){const t=e.id,r=i.id;return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]||H(t,r)}return("Graphic"===e.type||"I3S"===e.type)&&e.id===i.id}_updateFromIntersectionResult(e){let t;if("Terrain"===e.type&&i(e.point)){this.view.renderCoordsHelper.toRenderCoords(e.point,q),this.view.renderCoordsHelper.worldUpAtPosition(q,K);const i=this.view.basemapTerrain.elevationBounds,r=this.view.renderCoordsHelper.getAltitude(q),n=i?Math.abs(i.max-i.min)/Math.abs(r):100,s=r>0?1:-1;p(K,K),u(K,K,s*n),_(B,q,K),R(B,q,Q),t=this._getRayIntersection(Q)}else t=this._getRayIntersection(e.ray);return this._canUpdateFromIntersectionResult(t,e)?t.point:null}_updateAnalyses(e){if(!this.observer)return void this._set("updating",!1);if(this._analyses.some((e=>e.shouldIntersect))){const e=this._observer.intersection,t=e&&this._updateFromIntersectionResult(e);i(t)&&(this._observer.manipulator.location=t)}this._set("updating",this._updateAnalysis(this._tracker,"tracker")||this._analyses.items.some(((t,i)=>this._updateAnalysis(t,`${i}`,e))))}_updateAnalysis(e,t,r){if(!e.shouldRender)return e.engine.visualization.removeAllGeometries(),e.isDirty=!1,!1;if(!e.isDirty)return!1;if(e.shouldIntersect){const t=e.point.intersection,r=t&&this._updateFromIntersectionResult(t);i(r)&&(e.point.manipulator.location=r),e.shouldIntersect=!1}this.view.renderCoordsHelper.toRenderCoords(e.point.manipulator.location,e.engine.points.target),this.view.renderCoordsHelper.toRenderCoords(this._observer.manipulator.location,e.engine.points.observer);const n="tracker"===t||this._canComputeAnalysis(e),o=e.engine,a=o.points.observer,l=o.points.target;this._screenPixelSize=this.view.state.camera.computeScreenPixelSizeAt(a),this._observer.intersection?h(K,this._observer.intersection.normal):g(K,l,a);const c=this._screenPixelSize;p(K,K),u(K,K,Math.min(c,1)),_(B,a,K),e.point.intersection?h(K,e.point.intersection.normal):g(K,a,l);const d=this.view.state.camera.computeScreenPixelSizeAt(l);if(p(K,K),u(K,K,Math.min(d,1)),_(q,l,K),n){const t=R(B,q,Q);if(this.view.sceneIntersectionHelper.intersectToolIntersectorRay(t,this._intersector),e.hasIntersection=!!this._intersector.results.min&&this._intersector.results.min.getIntersectionPoint(J),e.isTargetVisible=!0,e.hasIntersection){h(o.points.intersection,J),h(o.points.intersectionObserver,B),h(o.points.intersectionTarget,q),this.view.renderCoordsHelper.fromRenderCoords(o.points.intersection,$,this.view.spatialReference);const t=1-m(q,l)/m(a,l);e.isTargetVisible=m(a,o.points.intersection)>=t*m(a,l)}e.isValid=!0;const i=new s($,this.view.spatialReference);e.target.intersectedLocation=e.isTargetVisible?null:i,e.target.intersectedGraphic=e.isTargetVisible?null:this._intersector.results.min.toGraphic(this.view),e.target.visible=!!e.hasIntersection&&e.isTargetVisible}else if(e.isValid){h(J,o.points.intersection);const t=m(e.engine.points.intersectionObserver,o.points.intersection)/m(e.engine.points.intersectionObserver,e.engine.points.intersectionTarget);v(X,B,e.engine.points.intersectionObserver),u(X,X,1-t),_(J,J,X),v(X,q,e.engine.points.intersectionTarget),u(X,X,t),_(J,J,X)}else e.hasIntersection=!1,e.target.intersectedLocation=null,e.target.intersectedGraphic=null,e.target.visible=void 0;return Y[12]=o.points.observer[0],Y[13]=o.points.observer[1],Y[14]=o.points.observer[2],g(B,B,o.points.observer),g(q,q,o.points.observer),g(J,J,o.points.observer),e.engine.visualization.removeAllGeometries(),e.isValid?(e.point.manipulator.state=e.isTargetVisible?16:32,e.engine.visualization.addGeometry(x(B,e.isTargetVisible?q:J,`${t}-visible-inner`),this._engineResources.visibleLineMaterialInner,Y),e.isTargetVisible?e.engine.visualization.addGeometry(x(B,e.isTargetVisible?q:J,`${t}-visible-outer`),this._engineResources.visibleLineMaterialOuter,Y):(e.engine.visualization.addGeometry(x(J,q,`${t}-occluded-inner`),this._engineResources.occludedLineMaterialInner,Y),e.engine.visualization.addGeometry(x(B,q,`${t}-occluded-outer`),this._engineResources.occludedLineMaterialOuter,Y))):(e.point.manipulator.state=64,e.engine.visualization.addGeometry(x(B,q,`${t}-observer-inner`),this._engineResources.undefinedLineMaterialInner,Y),e.engine.visualization.addGeometry(x(B,q,`${t}-observer-inner`),this._engineResources.undefinedLineMaterialOuter,Y)),e.isDirty=!1,!!r&&(r.madeProgress(),r.done)}};e([r({constructOnly:!0})],W.prototype,"view",void 0),e([r({dependsOn:["_showTracker","observer"],readOnly:!0})],W.prototype,"state",null),e([r({readOnly:!0,dependsOn:["_showTracker"]})],W.prototype,"cursor",null),e([r({dependsOn:["view.type"],readOnly:!0})],W.prototype,"isSupported",null),e([r({type:s})],W.prototype,"observer",void 0),e([r({type:U,nonNullable:!0})],W.prototype,"targets",void 0),e([r({type:D})],W.prototype,"configuration",void 0),e([r({readOnly:!0})],W.prototype,"updating",void 0),e([r()],W.prototype,"_showTracker",void 0),W=e([n("esri.views.3d.interactive.analysisTools.lineOfSight.LineOfSightTool")],W);const $=c(),B=c(),q=c(),J=c(),K=c(),Q=M(),X=c(),Y=C(),Z=k.create();export{U as LineOfSightTargetCollection,W as LineOfSightTool};
