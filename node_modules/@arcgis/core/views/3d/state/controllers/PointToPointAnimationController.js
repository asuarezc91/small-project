/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as t}from"../../../../chunks/tslib.es6.js";import"../../../../core/has.js";import"../../../../core/Logger.js";import"../../../../core/accessorSupport/ensureType.js";import{property as i}from"../../../../core/accessorSupport/decorators/property.js";import{subclass as e}from"../../../../core/accessorSupport/decorators/subclass.js";import"../../../../core/urlUtils.js";import"../../../../core/uuid.js";import"../../../../portal/support/resourceExtension.js";import{c as o}from"../../../../chunks/vec3f64.js";import n from"../../../ViewAnimation.js";import{Intersector as s}from"../../webgl-engine/lib/Intersector.js";import r from"../../webgl-engine/lib/Camera.js";import{Animation as a}from"../../animation/pointToPoint/Animation.js";import{AnimationController as m}from"./AnimationController.js";let c=class extends m{constructor(t){super(t),this.view=null,this.mode="interaction",this.hasTarget=!1}get intersectionHelper(){return this.view.sceneIntersectionHelper}initialize(){this.animation=new a(this.view.state.mode),this.viewAnimation="interaction"===this.mode?null:new n}get isInteractive(){return"interaction"===this.mode}begin(t,i){this.hasTarget=!0;const e=this.animationSettings(i);p.copyFrom(this.view.state.camera);const o=new s(this.view.state.mode);this.intersectionHelper.intersectRay(p.ray,o,h)&&(p.center=h),this.animation.update(p,t,e),this.animation.finished&&this.finish()}finish(){this.animation.currentTime=this.animation.time,super.finish()}get steppingFinished(){return this.hasTarget&&this.animation.finished}stepController(t,i){this.hasTarget&&this.animation.step(t,i)}onControllerEnd(t){this.hasTarget&&(this.animation.cameraAt(this.animation.currentTime/this.animation.time,t),this.animation.currentTime=this.animation.time),super.onControllerEnd(t)}animationSettings(t={}){return{apex:{maximumDistance:this.view.state.constraints.clampAltitude(1/0)/6,ascensionFactor:void 0,descensionFactor:void 0},speedFactor:t.speedFactor,duration:t.duration,maxDuration:t.maxDuration,easing:t.easing}}};t([i({constructOnly:!0})],c.prototype,"view",void 0),t([i({constructOnly:!0})],c.prototype,"mode",void 0),c=t([e("esri.views.3d.state.controllers.PointToPointAnimationController")],c);const p=new r,h=o();export{c as PointToPointAnimationController};
