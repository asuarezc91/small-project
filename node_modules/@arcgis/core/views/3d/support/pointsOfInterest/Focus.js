/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../../../../chunks/tslib.es6.js";import"../../../../core/has.js";import{removeMaybe as r,isSome as o}from"../../../../core/maybe.js";import"../../../../core/Logger.js";import"../../../../core/accessorSupport/ensureType.js";import{property as t}from"../../../../core/accessorSupport/decorators/property.js";import{subclass as s}from"../../../../core/accessorSupport/decorators/subclass.js";import"../../../../core/urlUtils.js";import"../../../../core/uuid.js";import"../../../../portal/support/resourceExtension.js";import n from"../../../../geometry/Point.js";import{clamp as i}from"../../../../core/mathUtils.js";import{createRenderScreenPointArray3 as c}from"../../../../core/screenUtils.js";import{c as a}from"../../../../chunks/vec3f64.js";import{f as p,n as l,d,g as u,e as m}from"../../../../chunks/vec3.js";import{ray as f}from"../geometryUtils.js";import h from"../debugFlags.js";import{PropertiesPool as g}from"../PropertiesPool.js";import{PointOfInterest as j}from"./PointOfInterest.js";import{GraphicsHandle as y}from"../debugUtils.js";const O=Array;let P=class extends j{constructor(e){super(e),this._propertiesPool=new g({location:n,renderLocation:O},this)}destroy(){this._propertiesPool.destroy(),this._propertiesPool=null,v=r(v)}get location(){const e=this._propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}get renderLocation(){const e=this.centerOnSurface.renderLocation,r=this.renderCoordsHelper,t=this.calculateScreenHorizontalEdgeOnSurface(b);p(H,e,this.state.camera.eye),l(H,H),r.worldUpAtPosition(e,C);const s=Math.abs(Math.acos(d(C,H))-.5*Math.PI),n=this._propertiesPool.get("renderLocation");if(Number.isNaN(s))u(n,e);else{const r=1-i(s/(.5*Math.PI),0,1);m(n,e,t,r*r*r)}return o(v)&&(h.SHOW_POI?v.showPoint(n,this.renderCoordsHelper.spatialReference):v.remove()),n}calculateScreenHorizontalEdgeOnSurface(e){const r=this.state.camera,o=this.renderCoordsHelper.getAltitude(this.centerOnSurface.renderLocation),t=this.renderCoordsHelper.getAltitude(r.eye)>=o,s=r.getRenderCenter(c());if(s[1]=t?r.padding[2]:r.fullHeight-r.padding[0],r.unprojectFromRenderScreen(s,L)){p(L,L,r.eye);const t=l(L,L);if(this.renderCoordsHelper.intersectManifold(f.wrap(r.eye,t),o,e))return e}return u(e,r.eye),this.renderCoordsHelper.setAltitude(o,e),e}updateRenderLocation(){}};function S(e){r(v),v=new y(e,"green")}e([t({constructOnly:!0})],P.prototype,"centerOnSurface",void 0),e([t({readOnly:!0})],P.prototype,"location",null),e([t({readOnly:!0})],P.prototype,"renderLocation",null),e([t({readOnly:!0,aliasOf:"centerOnSurface.updating"})],P.prototype,"updating",void 0),P=e([s("esri.views.3d.support.CenterOnSurface")],P);const H=a(),C=a(),L=a(),b=a();let v;var _=P;export default _;export{P as Focus,S as setupFocusDebugGraphic};
