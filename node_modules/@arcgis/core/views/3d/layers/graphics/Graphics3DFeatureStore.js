/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as t}from"../../../../chunks/tslib.es6.js";import"../../../../core/has.js";import{isSome as e,isNone as r}from"../../../../core/maybe.js";import"../../../../core/Logger.js";import"../../../../core/accessorSupport/ensureType.js";import{property as o}from"../../../../core/accessorSupport/decorators/property.js";import{subclass as s}from"../../../../core/accessorSupport/decorators/subclass.js";import"../../../../core/urlUtils.js";import"../../../../core/uuid.js";import"../../../../portal/support/resourceExtension.js";import i from"../../../../core/Accessor.js";import a from"../../../../core/Evented.js";import{projectPoint as p}from"../../../../geometry/projection.js";import c from"../../../../layers/graphics/OptimizedFeature.js";import n from"../../../../layers/graphics/OptimizedGeometry.js";import{getObjectId as h}from"../../../../layers/graphics/dehydratedFeatures.js";import{optimizedFeatureQueryEngineAdapter as l}from"../../../../layers/graphics/data/optimizedFeatureQueryEngineAdapter.js";let u=class extends i{constructor(t){super(t),this.events=new a,this.hasZ=null,this.hasM=null,this.objectIdField=null,this.spatialReference=null,this.featureAdapter={getAttribute:(t,e)=>"graphic"in t?t.graphic.attributes[e]:l.getAttribute(t,e),getAttributes:t=>"graphic"in t?t.graphic.attributes:l.getAttributes(t),getObjectId:t=>"graphic"in t?h(t.graphic,this.objectIdField):l.getObjectId(t),getGeometry:t=>"graphic"in t?t.getAsOptimizedGeometry(this.hasZ,this.hasM):l.getGeometry(t),getCentroid:(t,o)=>{if("graphic"in t){let s=null;e(t.centroid)?s=t.centroid:"point"===t.graphic.geometry.type&&p(t.graphic.geometry,d,this.spatialReference)&&(s=d);const i=new Array(2+(o.hasZ?1:0)+(o.hasM?1:0));return r(s)?(i[0]=0,i[1]=0,i[2]=0,i[3]=0):(i[0]=s.x,i[1]=s.y,o.hasZ&&(i[2]=s.hasZ?s.z:0),o.hasM&&(i[o.hasZ?3:2]=s.hasM?s.m:0)),new n([],i)}return l.getCentroid(t,o)},cloneWithGeometry:(t,e)=>"graphic"in t?new c(e,this.featureAdapter.getAttributes(t),null,this.featureAdapter.getObjectId(t)):l.cloneWithGeometry(t,e)}}forEach(t){this.forAllGraphics((e=>{t(e)}))}forEachInBounds(t,e){this.getSpatialIndex().forEachInBounds(t,e)}forEachBounds(t,r,o){const s=this.getSpatialIndex();for(const i of t){const t=this.featureAdapter.getObjectId(i);e(s.getBounds(t,o))&&r(o)}}};t([o({constructOnly:!0})],u.prototype,"getSpatialIndex",void 0),t([o({constructOnly:!0})],u.prototype,"forAllGraphics",void 0),t([o({constructOnly:!0})],u.prototype,"hasZ",void 0),t([o({constructOnly:!0})],u.prototype,"hasM",void 0),t([o({constructOnly:!0})],u.prototype,"objectIdField",void 0),t([o({constructOnly:!0})],u.prototype,"spatialReference",void 0),u=t([s("esri.views.3d.layers.graphics.Graphics3DFeatureStore")],u);const d={type:"point",x:0,y:0,hasZ:!1,hasM:!1,spatialReference:null};var m=u;export default m;export{u as Graphics3DFeatureStore};
