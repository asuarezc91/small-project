/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{isSome as t}from"../../../../core/maybe.js";import e from"../../../../layers/graphics/OptimizedGeometry.js";import{getCentroidOptimizedGeometry as r}from"../../../../layers/graphics/centroid.js";import{create as o}from"../../../../geometry/support/aaBoundingBox.js";import{getCachedAttributeValue as i}from"./I3SUtil.js";class n{constructor(t){this.objectIdField=t.objectIdField,this.getFeatureExtent=t.getFeatureExtent}getObjectId(t){return t.id}getAttributes(e){const{meta:r,index:o}=e,n={};this.objectIdField&&(n[this.objectIdField]=e.id);const s=t(r.attributeInfo)&&r.attributeInfo.attributeData;if(t(s))for(const t of Object.keys(s))n[t]=i(s[t],o);return n}getAttribute(e,r){if(r===this.objectIdField)return e.id;const{meta:o,index:n}=e,s=t(o.attributeInfo)&&o.attributeInfo.attributeData;return t(s)?i(s[r],n):null}getGeometry(t){if(t.geometry)return t.geometry;const[r,o,i,n,a]=this.getFeatureExtent(t,s);return new e([5],[r,o,i,n,o,i,n,a,i,r,a,i,r,o,i])}getCentroid(t,o){if(t.geometry)return r(new e,t.geometry,o.hasZ,o.hasM);const[i,n,a,m,u,d]=this.getFeatureExtent(t,s);return new e([0],[(i+m)/2,(n+u)/2,(a+d)/2])}cloneWithGeometry(t,e){const{id:r,index:o,meta:i}=t;return{id:r,index:o,meta:i,geometry:e}}}const s=o();export{n as I3SQueryFeatureAdapter};
