/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../../../../chunks/tslib.es6.js";import"../../../../core/has.js";import{isSome as t,isNone as s,unwrap as i}from"../../../../core/maybe.js";import r from"../../../../core/Logger.js";import"../../../../core/accessorSupport/ensureType.js";import{property as a}from"../../../../core/accessorSupport/decorators/property.js";import{subclass as n}from"../../../../core/accessorSupport/decorators/subclass.js";import"../../../../core/urlUtils.js";import"../../../../core/uuid.js";import"../../../../portal/support/resourceExtension.js";import{resolve as o,createAbortController as u,isAbortError as l,eachAlways as h}from"../../../../core/promiseUtils.js";import{schedule as c}from"../../../../core/scheduling.js";import d from"../../../../core/Accessor.js";import p from"../../../../core/Handles.js";import{on as f}from"../../../../core/watchUtils.js";import{equals as m,toExtent as g,create as y}from"../../../../geometry/support/aaBoundingRect.js";import{ImmediateTask as F,Task as T}from"../../../support/Scheduler.js";import x from"../../../../tasks/support/QuantizationParameters.js";import R from"../../../../tasks/support/Query.js";import{someMap as C}from"../../../../core/MapUtils.js";import{getObjectId as E,hasVertices as v}from"../../../../layers/graphics/dehydratedFeatures.js";import{tilesAreRelated as b}from"../../terrain/tileUtils.js";import{MultiFeatureReference as M,SingleFeatureReference as _}from"./featureReference.js";import{FAILED_FEATURE_COUNT as j,FeatureTile as w}from"./FeatureTile.js";const D=r.getLogger("esri.views.3d.layers.support.FeatureTileFetcher3D");let O=class extends d{constructor(e){super(e),this._useTileCount=!1,this.updating=!1,this.updatingTotal=0,this.updatingRemaining=0,this.expectedFeatureDiff=0,this.maximumNumberOfFeaturesExceeded=!1,this.maximumNumberOfFeaturesExceededThrottle=1e3,this._fullRatio=1,this._farRatio=1,this.changes={updates:{adds:new Array,removes:new Array},adds:new Array,removes:new Array},this.handles=new p,this._frameTask=F,this._dirty=!1,this.featureTiles=new Map,this.displayingFeatureReferences=new Map,this.numDisplayingFeatureReferences=0,this.suspended=!0,this.pendingEdits=null}set maximumNumberOfFeatures(e){e=e||1/0;const t=this._get("maximumNumberOfFeatures");e===t||e<1||(this._set("maximumNumberOfFeatures",e),this.maximumFeaturesUpdated(t,e))}set memoryFactor(e){this.memoryFactor!==e&&(this._set("memoryFactor",e),this.setDirty())}set lodFactor(e){this.lodFactor!==e&&(this._set("lodFactor",e),this.supportsResolution&&this.refetch())}get useTileCount(){return this._useTileCount&&t(this.context.query.queryFeatureCount)}set useTileCount(e){this._useTileCount=e,this.notifyChange("useTileCount")}get memoryForUnusedFeatures(){let e=0;return this.featureTiles.forEach((t=>e+=t.estimatedUnusedSize)),e}get totalVertices(){let e=0;return this.featureTiles.forEach((t=>e+=t.numVertices)),e}get totalFeatures(){let e=0;return this.featureTiles.forEach((t=>e+=t.numFeatures)),e}set filterExtent(e){if(e&&this.context.tilingScheme&&!e.spatialReference.equals(this.context.tilingScheme.spatialReference))return void D.error("#filterExtent=","extent needs to be in the same spatial reference as the tiling scheme");const t=this._get("filterExtent");if(t===e||t&&e&&t.equals(e))return;const s=e?e.clone():null;this._set("filterExtent",s),this.reclip(s,t)}initialize(){this.handles.add(f(this,"tileDescriptors","change",(()=>this.setDirty()),(()=>this.setDirty()))),this.objectIdField=this.context.objectIdField,this.FeatureReferenceClass=this.context.capabilities.supportsMultipleResolutions?M:_;const e=this.context.scheduler;t(e)&&(this._frameTask=e.registerTask(T.FEATURE_TILE_FETCHER,(e=>this._process(e)),(()=>this.updating))),this.setDirty()}destroy(){this._frameTask.remove(),this.handles&&(this.handles.destroy(),this.handles=null),this.featureTiles.forEach((e=>{this.cancelFetchTile(e),this.removeTile(e)})),this.featureTiles.clear(),this.displayingFeatureReferences.clear(),this.pendingEdits&&(this.pendingEdits.controller.abort(),this.pendingEdits=null)}get paused(){return this.suspended||!!this.pendingEdits}restart(){this.featureTiles.forEach((e=>{this.cancelFetchTile(e),this.clearTile(e),this.resetFetchTile(e)})),t(this.context.memoryCache)&&this.context.memoryCache.clear(),this.setDirty()}refetch(){this.featureTiles.forEach((e=>{this.cancelFetchTile(e),this.resetFetchTile(e)})),t(this.context.memoryCache)&&this.context.memoryCache.clear(),this.setDirty()}suspend(){this.suspended||(this.suspended=!0,this.pause(),this.setDirty())}resume(){this.suspended&&(this.suspended=!1,this.unpause())}pause(){this.paused&&(this.featureTiles.forEach((e=>this.cancelFetchTile(e))),this.updated())}unpause(){this.paused||(this.setDirty(),this.updated())}get availableFields(){let e=null;return this.featureTiles.forEach((t=>{t.displayingFeatures&&0!==t.displayingFeatures.length&&(s(e)?e=new Set(t.availableFields):e.forEach((s=>{t.availableFields.has(s)||i(e).delete(s)})))})),t(e)?e:new Set}applyEdits(e){this.pendingEdits||(this.pendingEdits={edits:o(),count:0,controller:u()},this.pause());const s=this.pendingEdits;s.count++;const i=s.edits.then((()=>e.result.catch((e=>{if(l(e))throw e;return null})).then((e=>e?(this.applyEditsDeleteFeatures(e.deletedFeatures),this.applyEditsAddUpdateFeatures(e.addedFeatures,e.updatedFeatures,s.controller.signal).then((()=>e))):e)).then((e=>(0==--s.count&&(this.pendingEdits===s&&(this.pendingEdits=null),t(this.context.memoryCache)&&this.context.memoryCache.clear(),this.unpause(),this.updated()),e)))));return s.edits=i,this.updated(),i}applyEditsDeleteFeatures(e){if(0===e.length)return;const t=new Set;e.forEach((e=>t.add(e.objectId))),this.featureTiles.forEach((e=>{if(!e.features)return;const s=e.features.filter((e=>!t.has(E(e,this.objectIdField))));s.length!==e.features.length&&(e.setFeatures(s,0,e.availableFields),this.invalidateCounts())}))}async applyEditsAddUpdateFeatures(e,t,s){const i=[],r=new Set;if(e.forEach((e=>i.push(e.objectId))),t.forEach((e=>{i.push(e.objectId),r.add(e.objectId)})),0===i.length)return;const a=[];this.featureTiles.forEach((e=>{const t=this.applyEditsAddUpdateTile(e,i,r,s);t&&a.push(t)})),await h(a)}async applyEditsAddUpdateTile(e,t,s,i){if(!e.features)return;const r=this.createQuery(e);r.resultType=void 0,r.cacheHint=!1,r.objectIds=t;const a=await this.queryFeatures(r,i);let n=null;if(s.size>0){const t=e.features.filter((e=>!s.has(E(e,this.objectIdField))));t.length!==e.features.length&&(n=t)}if(a.features.length>0){n||(n=e.features.slice());for(const e of a.features)n.push(e)}n&&(e.setFeatures(n,0,N(e.availableFields,a.fields)),this.invalidateCounts())}queryFeatures(e,t){return this.context.query.queryFeaturesDehydrated(e,{signal:t,timeout:L})}setDirty(){this._dirty=!0,this.updated()}_process(e){if(!this._dirty||!this.constructed)return;this._dirty=!1;const t=this.getListOfTiles();if(this.markTilesNotAlive(t),!e.run((()=>this.addTiles(t,e)))||!e.run((()=>this.filterExtentTiles(t,e)))||!e.run((()=>this.removeTiles(t,e)))||e.done)return void this.setDirty();const s=this.sortTiles(t);e.run((()=>this.displayTiles(s,e)))&&e.run((()=>this.fetchTiles(s,e)))&&e.run((()=>this.updateMemoryEstimates(s,e)))||this.setDirty(),this.updated(),this.updating||this.updateMaximumNumberOfFeaturesExceeded()}markTilesNotAlive(e){for(const t of e)t.alive=!1}addTiles(e,t){return!this.suspended&&(this.tileDescriptors.forEach((s=>{const i=this.featureTiles.get(s.id);i?i.alive=!0:t.done||(e.push(this.addTile(s)),t.madeProgress())})),t.hasProgressed)}filterExtentTiles(e,t){for(const s of e){if(t.done)break;s.alive&&(s.filtered=!s.intersects(this.filterExtent),s.filtered&&(this.clearTile(s),t.madeProgress()))}return t.hasProgressed}removeTiles(e,t){for(let s=e.length-1;s>=0&&!t.done;s--){const i=e[s];i.alive||(this.removeTile(i),s!==e.length-1&&(e[s]=e[e.length-1]),e.pop(),t.madeProgress())}return t.hasProgressed}sortTiles(e){return e.sort(((e,t)=>e.descriptor.loadPriority-t.descriptor.loadPriority)),e}displayTiles(e,t){const s=this.updateRatio(e),i=e=>{const t=this._fullRatio<1?s(e)*this._farRatio:1;return e.reduceFeatures(t,this.memoryFactor,this.objectIdField)&&this.setDirty(),this.showTile(e)};for(const s of e)if(!t.run((()=>i(s)))){this.setDirty();break}return t.hasProgressed}fetchTiles(e,s){if(this.paused)return!1;let i=!1;for(const r of e){if(!r.needsFetching)continue;const e=t(this.context.memoryCache)?this.context.memoryCache.pop(r.id):null;if(t(e))r.cache=e,this.setDirty(),this.scheduleUpdated(),s.madeProgress();else{if(this.needsNumFeatures(r)){const e=u(),t=this.fetchTileCount(r,e.signal);this._handleRequest(r,t,e,(()=>r.numFeatures=j)),i=!0,s.madeProgress()}if(s.done)return!0}}if(i)return s.hasProgressed;for(const t of e)if(t.needsFetching){const e=u(),i=this.fetchTile(t,e.signal);if(this._handleRequest(t,i,e,(e=>{t.setFeatures([],0,null),this.invalidateCounts(),t.featuresMissing=!1,this.context.logFetchError(D,e)})),s.madeProgress(),s.done)return!0}return s.hasProgressed}updateMemoryEstimates(e,t){return e.some((e=>!t.run((()=>e.updateMemoryEstimates()))&&(this.setDirty(),!0))),t.hasProgressed}reclip(e,t){this.constructed&&(this.featureTiles.forEach((s=>{s.displayingFeatures&&0!==s.displayingFeatures.length&&(s.intersection(t,Q),s.intersection(e,I),m(Q,I)||this.hideTileFeatures(s))})),this.featureTiles.forEach((e=>this.showTile(e))),this.updated())}updated(){let e=0;this.paused||this.featureTiles.forEach((t=>t.isFetching?++e:0));const t=this._dirty||e>0||!!this.pendingEdits;if(this._set("updating",t),t){let t=0,s=0,i=0,r=0,a=0,n=0;const o=this.displayingFeatureReferences.size/this.numDisplayingFeatureReferences;this.featureTiles.forEach((e=>{if(++i,e.isFetching&&e.hasPreciseFeatureCount){const t=this.maximumFeaturesForTile(e)*(1-e.emptyFeatureRatio),s=e.displayingFeatures?e.displayingFeatures.length*o:0;n+=t-s}e.needsFetching?++a:e.numFeatures>0&&(++r,s+=e.numFeatures)})),a+=e;let u=0;s?(t=s,u=Math.min(a*s/r,s)):(t=i,u=a),n=Math.min(this.maximumNumberOfFeatures-this.features.length,n),this._set("updatingTotal",t),this._set("updatingRemaining",u),this._set("expectedFeatureDiff",n)}else this._set("updatingTotal",0),this._set("updatingRemaining",0),this._set("expectedFeatureDiff",0);this.debugger&&this.debugger.update()}updateMaximumNumberOfFeaturesExceeded(){const e=C(this.featureTiles,(e=>e.perTileMaximumNumberOfFeaturesExceeded));this._set("maximumNumberOfFeaturesExceeded",e)}updateRatio(e){const t=function(e){let t=0;for(const s of e)s.features&&s.features.length>0&&s.alive&&(t=Math.max(t,s.descriptor.lij[0]));return t}(e),s=e=>1/(1<<Math.max(0,t-e.descriptor.lij[0]));let i=0,r=0;for(const t of e){const e=t.numFeatures;i+=e,r+=e*s(t)}return this._fullRatio=Math.min(1,this.maximumNumberOfFeatures/i),this._farRatio=this.maximumNumberOfFeatures/r,this.scheduleUpdated(),s}maximumFeaturesUpdated(e,t){e!==t&&(t>e&&this.featureTiles.forEach((e=>{if(!e.featuresMissing)return;const t=this.maximumFeaturesForTile(e);e.features&&(e.features.length>=t||5===e.fetchStatus)||(this.cancelFetchTile(e),this.resetFetchTile(e))})),this.setDirty())}addTile(e){const t=new w(e);return this.featureTiles.set(t.id,t),this.resetFetchTile(t),this.referenceDisplayingFeaturesFromRelatedTiles(t),t}referenceDisplayingFeaturesFromRelatedTiles(e){const t=e.descriptor.resolution;this.featureTiles.forEach((s=>{if(s.displayingFeatures&&e!==s&&(!e.descriptor.lij||!s.descriptor.lij||b(e.descriptor.lij,s.descriptor.lij))){e.displayingFeatures=e.displayingFeatures||[];for(const i of s.displayingFeatures){e.displayingFeatures.push(i);const s=this.displayingFeatureReferences.get(E(i,this.objectIdField));s.ref(s.feature,t),this.numDisplayingFeatureReferences++}}})),e.featureLimit=e.displayingFeatures?e.displayingFeatures.length:0}removeTile(e){this.clearTile(e),this.featureTiles.delete(e.id)}resetFetchTile(e){e.filtered=!e.intersects(this.filterExtent),e.filtered?e.needsFetching&&(e.fetchStatus=4):e.fetchStatus=0}cancelFetchTile(e){const s=e.requestController;t(s)&&(e.requestController=null,e.resetFetching(),s.abort())}async fetchTileCount(e,t){return e.numFeatures=await this.fetchCount(e,t),this.updateRatio(this.getListOfTiles()),3===e.fetchStatus?1:0}async fetchTile(e,t){const s=this.maximumFeaturesForTile(e);if(s<=0)return function(e){return e.setFeatures([],0,null),e.featuresMissing=!1,4}(e);const i=this.getMaxRecordCount(e),r=Math.ceil(s/i);if(P(e)||!this.context.capabilities.supportsMaxRecordCountFactor||e.numFeatures<=s&&r>R.MAX_MAX_RECORD_COUNT_FACTOR)return this.fetchPagedTile(e,t);const a=this.createQuery(e);if(a.maxRecordCountFactor=Math.ceil(s/i),e.isRefetching&&e.features&&e.features.length>0){const t=Math.ceil(e.features.length/(1-e.emptyFeatureRatio)/i);a.maxRecordCountFactor=Math.max(t+1,a.maxRecordCountFactor)}const{features:n,exceededTransferLimit:o,fields:u}=await this.queryFeatures(a,t),l=o?a.maxRecordCountFactor>=R.MAX_MAX_RECORD_COUNT_FACTOR?5:4:5;return await this._frameTask.schedule((()=>{e.featuresMissing=n.length<e.numFeatures||o;const t=this._removeEmptyFeatures(n);e.setFeatures(n,t,S(u))}),t),this.invalidateCounts(),l}async fetchCount(e,t){return this.context.query.queryFeatureCount(this.createFeatureCountQuery(e),{signal:t})}async fetchPagedTile(e,t){let s,r=0,a=0,n=0,o=this.maximumFeaturesForTile(e)-n;const u=this.getMaxRecordCount(e);let l=null;for(;;){const h=this.createQuery(e),c=this.setPagingParameters(h,r,o,u),{features:d,exceededTransferLimit:p,fields:f}=await this.queryFeatures(h,t);if(await this._frameTask.schedule((()=>{c&&(r+=i(h.num)),n+=d.length,a+=this._removeEmptyFeatures(d),e.featuresMissing=r<e.numFeatures||p,s=s?s.concat(d):d,l=N(l,f),e.setFeatures(s,a,l)}),t),this.invalidateCounts(),this.setDirty(),o=this.maximumFeaturesForTile(e)-n,!c||!p||o<=0)return p?4:5}}createFeatureCountQuery(e){const t=this.createQuery(e);return this.context.capabilities.supportsCacheHint&&(t.resultType=void 0,t.cacheHint=!0),t}createQuery(e){const t=this.context.createQuery(),s=e.descriptor.extent;if(s){const e=this.context.tilingScheme.spatialReference;t.geometry=g(s,e)}return this.setResolutionParams(t,e),this.useTileQuery(e)?t.resultType="tile":this.context.capabilities.supportsCacheHint&&(t.cacheHint=!0),t}setPagingParameters(e,t,s,i){return!!this.context.capabilities.supportsPagination&&(e.start=t,s>0&&this.context.capabilities.supportsMaxRecordCountFactor?(e.maxRecordCountFactor=Math.ceil(s/i),e.num=Math.min(e.maxRecordCountFactor*i,s)):e.num=Math.min(i),!0)}getEffectiveTileResolution(e){if(null==e.descriptor.resolution)return null;const t=1===this.context.viewingMode?this.context.tilingScheme.resolutionAtLevel(3):1/0;return Math.min(e.descriptor.resolution,t)/this.lodFactor}get supportsResolution(){return this.context.capabilities.supportsMultipleResolutions&&"point"!==this.context.geometryType}setResolutionParams(e,t){if(!this.supportsResolution)return;const s=this.getEffectiveTileResolution(t);null!=s&&(this.context.capabilities.supportsQuantization?e.quantizationParameters=new x({mode:"view",originPosition:"upper-left",tolerance:s,extent:this.context.fullExtent}):"polyline"===this.context.geometryType&&(e.maxAllowableOffset=s))}_removeEmptyFeatures(e){const t=e.length;for(let t=0;t<e.length;){const s=e[t];v(s.geometry)?++t:(e[t]=e[e.length-1],--e.length)}return t-e.length}needsNumFeatures(e){return this.useTileCount&&e.needsFeatureCount&&!P(e)}getMaxRecordCount(e){const{tileMaxRecordCount:s,maxRecordCount:i}=this.context;return this.useTileQuery(e)&&t(s)&&s>0&&this.context.capabilities.supportsResultType?s:t(i)&&i>0?i:A}useTileQuery(e){return(!P(e)||!this.context.capabilities.supportsCacheHint)&&this.context.capabilities.supportsResultType}_handleRequest(e,t,s,i){e.fetchStatus=e.needsRefetching?3:2,e.requestController=s;let r=!1;t.then((t=>{e.requestController=null,e.fetchStatus=t})).catch((t=>{e.requestController===s&&(e.requestController=null,e.fetchStatus=4),l(t)?r=!0:i(t)})).then((()=>{r||this.setDirty(),this.scheduleUpdated()}))}scheduleUpdated(){this.handles&&!this.handles.has("scheduleUpdated")&&this.handles.add(c((()=>{this.handles.remove("scheduleUpdated"),this.updated()})),"scheduleUpdated")}showTile(e){if(e.displayingFeatures&&!e.needsDisplayUpdate)return!1;const t=e.features;if(0===e.featureLimit||!t){const t=e.displayingFeatures&&e.displayingFeatures.length>0;return this.hideTileFeatures(e),e.displayingFeatures=[],t}const s=e.descriptor.resolution,i=this.changes.updates,r=this.changes.adds,a=Math.min(e.featureLimit,t.length);e.featureLimit=a;for(let e=0;e<a;++e){const a=t[e],n=E(a,this.objectIdField),o=this.displayingFeatureReferences.get(n);if(o){const e=o.ref(a,s);e.oldVersion!==e.newVersion&&(i.removes.push(e.oldVersion),i.adds.push(e.newVersion))}else this.displayingFeatureReferences.set(n,new this.FeatureReferenceClass(a,s)),r.push(a);this.numDisplayingFeatureReferences++}return this.hideTileFeatures(e),this.applyChanges(),e.displayingFeatures=t.slice(0,a),!0}hideTile(e){this.cancelFetchTile(e),this.hideTileFeatures(e)}hideTileFeatures(e){if(!e.displayingFeatures)return;const t=this.changes.updates,s=this.changes.removes;for(const i of e.displayingFeatures){const r=E(i,this.objectIdField),a=this.displayingFeatureReferences.get(r);if(!a)continue;const n=a.unref(e.descriptor.resolution);this.numDisplayingFeatureReferences--,n?n.oldVersion!==n.newVersion&&(null==n.newVersion?(this.displayingFeatureReferences.delete(r),s.push(n.oldVersion)):(t.adds.push(n.newVersion),t.removes.push(n.oldVersion))):console.error("Hiding unreferenced feature")}this.applyChanges(),e.displayingFeatures=null}applyChanges(){const e=this.changes.updates;e.removes.length>0&&(this.features.removeMany(e.removes),e.removes.length=0),e.adds.length>0&&(this.features.addMany(e.adds),e.adds.length=0);const t=this.changes.adds,s=this.changes.removes,i=Math.min(t.length,s.length);let r=0;for(;r<i;){const e=Math.min(r+V,i);this.features.addMany(t.slice(r,e)),this.features.removeMany(s.slice(r,e)),r=e}t.length>i&&this.features.addMany(0===r?t:t.slice(r)),s.length>i&&this.features.removeMany(0===r?s:s.slice(r)),t.length=0,s.length=0}clearTile(e){if(this.hideTile(e),e.features&&t(this.context.memoryCache)){const t=16+e.estimatedSize;this.context.memoryCache.put(e.id,e.cache,t)}e.setFeatures(null,0,null),this.invalidateCounts()}invalidateCounts(){this.notifyChange("totalVertices"),this.notifyChange("totalFeatures"),this.notifyChange("memoryForUnusedFeatures")}getListOfTiles(){return Array.from(this.featureTiles.values())}get storedFeatures(){return this.getListOfTiles().reduce(((e,t)=>e+(t.features?t.features.length:0)),0)}maximumFeaturesForTile(e){const t=e.hasPreciseFeatureCount?e.numFeatures:1/0,s=e.hasPreciseFeatureCount?t:this.maximumNumberOfFeatures,i=this._fullRatio<1?this._farRatio:1;return Math.min(Math.ceil(s*i/(1-e.emptyFeatureRatio)),t)}get test(){return{process:e=>this._process(e),getFeatureTileById:e=>this.featureTiles.get(e),forEachFeatureTile:e=>this.featureTiles.forEach(e)}}};function P(e){return"dummy-tile-full-extent"===e.id}function U(e){const t=e.capabilities.query;return{supportsMultipleResolutions:q(e),supportsPagination:!(!t||!t.supportsPagination),supportsResultType:!(!t||!t.supportsResultType),supportsCacheHint:!(!t||!t.supportsCacheHint),supportsQuantization:!(!t||!t.supportsQuantization),supportsQuantizationEditMode:!(!t||!t.supportsQuantizationEditMode),supportsMaxRecordCountFactor:!(!t||!t.supportsMaxRecordCountFactor),supportsFormatPBF:!(!t||!t.supportsFormatPBF)}}function q(e){switch(e.geometryType){case"polyline":return!0;case"polygon":return e.capabilities&&e.capabilities.query&&e.capabilities.query.supportsQuantization;default:return!1}}function S(e){return s(e)?new Set:new Set(e.map((e=>e.name)))}function N(e,t){if(s(e)||s(t))return S(t);const i=new Set;for(const{name:s}of t)e.has(s)&&i.add(s);return i}e([a({constructOnly:!0})],O.prototype,"features",void 0),e([a()],O.prototype,"tileDescriptors",void 0),e([a({value:1/0})],O.prototype,"maximumNumberOfFeatures",null),e([a({value:1})],O.prototype,"memoryFactor",null),e([a({value:1})],O.prototype,"lodFactor",null),e([a({dependsOn:["context"]})],O.prototype,"useTileCount",null),e([a({readOnly:!0})],O.prototype,"updating",void 0),e([a({readOnly:!0})],O.prototype,"updatingTotal",void 0),e([a({readOnly:!0})],O.prototype,"updatingRemaining",void 0),e([a({readOnly:!0})],O.prototype,"expectedFeatureDiff",void 0),e([a({readOnly:!0})],O.prototype,"memoryForUnusedFeatures",null),e([a({readOnly:!0})],O.prototype,"maximumNumberOfFeaturesExceeded",void 0),e([a({constructOnly:!0})],O.prototype,"maximumNumberOfFeaturesExceededThrottle",void 0),e([a({readOnly:!0})],O.prototype,"totalVertices",null),e([a({readOnly:!0})],O.prototype,"totalFeatures",null),e([a()],O.prototype,"filterExtent",null),e([a({constructOnly:!0})],O.prototype,"context",void 0),O=e([n("esri.views.3d.layers.support.FeatureTileFetcher3D")],O);const A=2e3,Q=y(),I=y(),L=6e5,V=200;var k=O;export default k;export{O as FeatureTileFetcher3D,U as contextCapabilitiesFromLayer};
