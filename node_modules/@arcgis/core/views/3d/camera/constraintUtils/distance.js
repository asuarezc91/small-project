/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{c as t}from"../../../../chunks/vec3f64.js";import{k as e,g as r,f as n,b as i}from"../../../../chunks/vec3.js";import{directionFromTo as o}from"../../support/mathUtils.js";import{sphere as s,ray as c}from"../../support/geometryUtils.js";import{defaultApplyOptions as a,interactionDirectionTowardsConstraintMinimization as f,adjustRangeForInteraction as m}from"./common.js";function u(t,e,r=a){if(!t.state.isLocal)return 0;const n=t.state.constraints.distance;if(!t.pointsOfInterest.surfaceOrigin.renderLocation||n===1/0)return 0;d.min=0,d.max=n,function(t,e,r){const n=e.interactionType;if(0===n)return;const{min:i,max:o}=r,{interactionStartCamera:s,interactionFactor:c}=e,a=1===n||4===n,f=u(t,s),p=0===f?0:y(t,s);r.min=i,r.max=o;m(f,p,a,c,.05*p,r)}(t,r,d);const i=y(t,e),o=d.max-i;return o>=-1e-6?0:o}function p(t,e,m=a){const p=u(t,e,m);if(0===p)return!1;const d=t.pointsOfInterest.surfaceOrigin,j=y(t,e)+p,k=r(O,e.eye),I=f(e,m.interactionDirection,function(t,e,r){const n=t.pointsOfInterest.surfaceOrigin;return o(r,e.eye,n.renderLocation)}(t,e,x),l);if(s.intersectRay(s.wrap(j,d.renderLocation),c.wrap(e.eye,I),e.eye)){const r=n(g,e.eye,k);i(e.center,e.center,r),e.markViewDirty();const o=t.renderCoordsHelper.getAltitude(e.center);return t.renderCoordsHelper.intersectInfiniteManifold(e.ray,o,e.center),e.markViewDirty(),!0}return!1}function y(t,r){const n=t.pointsOfInterest.surfaceOrigin;return e(r.eye,n.renderLocation)}const d={min:0,max:0},O=t(),g=t(),l=t(),x=t();export{p as applyDistanceConstraint,u as getDistanceConstraintError};
