/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{c as e}from"../../../chunks/vec3f64.js";import{g as r,h as n,a as t,f as o,b as i,d as s,l as a}from"../../../chunks/vec3.js";import{getReferenceEllipsoid as c}from"../../../geometry/projectionEllipsoid.js";import{containsPoint as l}from"../../../geometry/support/aaBoundingRect.js";import{Intersector as d}from"../webgl-engine/lib/Intersector.js";function u(e,r,n,t){return e.renderCoordsHelper.fromRenderCoords(r.eye,y,t)&&l(n,y)}function f(e,r){return e.elevationProvider&&e.elevationProvider.getElevation(r[0],r[1],r[2],e.renderCoordsHelper.spatialReference,"ground")||0}function p(l,u,f,p){const y=l.state.camera.clone();u&&(y.eye=u),f&&(y.center=f),p&&(y.up=p),function(r,n,o=e()){let l=m[r.viewingMode];l||(l=new d(r.state.mode),l.options.backfacesTerrain=!r.state.isGlobal,l.options.invisibleTerrain=!0,m[r.viewingMode]=l);const{isGlobal:u}=r.state;if(r.sceneIntersectionHelper.intersectRay(n,l,o)&&!g(r,n.origin,o))return!0;if(!r.renderCoordsHelper.intersectManifold(n,0,o)||g(r,n.origin,o))return!!u&&function(e,r,n){const o=s(e.origin,e.origin),c=o-n*n,l=c>0?Math.sqrt(c)/3:1;return t(r,e.direction,l/a(e.direction)),i(r,r,e.origin),!0}(n,o,c(r.spatialReference).radius);return!0}(l,y.ray,v)||r(v,y.center);const M=l.state.constraints,j=M.minimumPoiDistance;if(n(y.eye,v)<j){const e=M.collision.enabled;r(b,y.viewForward),t(b,b,j),e?o(y.eye,v,b):i(v,y.eye,b);const n=l.renderCoordsHelper,s=n.getAltitude(y.eye),a=M.collision.elevationMargin;e&&s<a&&(o(b,v,y.eye),n.setAltitude(a,y.eye),i(v,y.eye,b))}return y.center=v,y}function g(e,r,t){if(!e.state.isGlobal)return!1;const o=f(e,r),i=e.stateManager.constraintsManager.nearFarHeuristic,{far:s}=i.compute(r,t,e.dataExtent,o,M),a=s*s;return n(r,t)>a}const m={},y=e(),v=e(),b=e(),M={near:0,far:0};export{p as cameraOnContentAlongViewDirection,u as eyeWithinExtent,f as surfaceElevationBelowRenderLocation};
