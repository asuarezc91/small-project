/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{isSome as e}from"../../../core/maybe.js";import{defaults as t}from"./Settings.js";import{squareDistance as r,anyMapPointToScreenPoint as s}from"./snappingUtils.js";class o{constructor({proximityThreshold:e,enabled:r=!0,shortLineThreshold:s=t.shortLineThreshold}){this.enabled=r,this.squaredShortLineThreshold=s*s;const o=e*t.touchSensitivityMultiplier;this._squaredTouchProximityThreshold=o*o,this._squaredMouseProximityTreshold=e*e}snap(t,r){return this.enabled?e(r.vertexHandle)?"vertex"!==r.vertexHandle.type?[]:this.snapExistingVertex(t,r):this.snapNewVertex(t,r):[]}edgeExceedsShortLineThreshold(e,t){return this.exceedsShortLineThreshold(e.left.pos,e.right.pos,t)}exceedsShortLineThreshold(e,t,{elevationInfo:o,view:i,geometry:h}){const n=h.data.coordinateHelper;return 0===this.squaredShortLineThreshold||r(s(t,n,o,i),s(e,n,o,i))>this.squaredShortLineThreshold}squaredProximityTreshold(e){return"touch"===e?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold}}class i{constructor(e,t,r,s,o=null){this.geometry=e,this.view=t,this.elevationInfo=r,this.pointer=s,this.vertexHandle=o}}export{o as SnappingAlgorithm,i as SnappingContext};
