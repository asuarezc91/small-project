/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{handlesGroup as e,destroyHandle as t}from"../../../core/handleUtils.js";import i from"../../../Color.js";import{e as r}from"../../../chunks/vec3.js";import{d as n,h as a}from"../../../chunks/vec2.js";import{defaults as s}from"./Settings.js";import{createLineSegmentHintFromEdge as o,createLineSegmentHintFromMap as l,anyMapPointToRender as f}from"./snappingUtils.js";import{SnappingCandidate as c}from"./SnappingCandidate.js";import{LineConstraint as d}from"./SnappingConstraint.js";import{ParallelLineVisualElement as h}from"../../3d/interactive/visualElements/ParallelLineVisualElement.js";class p extends c{constructor({coordinateHelper:e,referenceLine:t,lineStart:i,targetPoint:r}){const s=e.clone(i);n(s,a(s,s,t.right.pos),t.left.pos),super(e,r,new d(i,s)),this._referenceLines=[{edge:t,fadeLeft:!0,fadeRight:!0}]}visualizeReferenceHints(i,r,n){return e([...this._referenceLines.map((e=>t(o(1,e.edge,this.coordinateHelper,r,i,e.fadeLeft,e.fadeRight)))),t(this.createParallelLineVisualElement(i,r,this.constraint.start,n))])}visualizeTargetHints(i,r,n){return e([t(l(0,this.constraint.start,n,this.coordinateHelper,r,i))])}addReferenceLine(e){const t={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach((i=>{e.right.right===i.edge&&(i.fadeLeft=!1,t.fadeRight=!1),e.left.left===i.edge&&(i.fadeRight=!1,t.fadeLeft=!1)})),this._referenceLines.push(t)}createParallelLineVisualElement(e,t,n,a){const o=f(n,this.coordinateHelper,t,e),l=f(a,this.coordinateHelper,t,e),c=r(l,o,l,.5),d=new h({view:e,attached:!1,offset:s.parallelLineHintOffset,length:s.parallelLineHintLength,width:s.parallelLineHintWidth,color:i.toUnitRGBA(s.orange),location:c,renderOccluded:16});return d.setDirectionFromPoints(o,c),d.attached=!0,d}}export{p as ParallelLineSnappingCandidate};
