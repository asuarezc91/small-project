/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import"../../../../core/has.js";import"../../../../core/mathUtils.js";import"../../../../chunks/builtins.js";import r from"../../../webgl/BufferObject.js";import t from"../../../webgl/VertexArrayObject.js";import"../../../webgl/FramebufferObject.js";import{createProgram as e}from"../../../webgl/programUtils.js";import"../../../webgl/RenderingContext.js";import{bitBlit as i}from"./shaders/BitBlitPrograms.js";class s{constructor(){this._initialized=!1}dispose(){this._program&&(this._program.dispose(),this._program=null),this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)}render(r,t,e,i){r&&(this._initialized||this._initialize(r),r.setBlendFunctionSeparate(1,771,1,771),r.bindVAO(this._vertexArrayObject),r.bindProgram(this._program),t.setSamplingMode(e),r.bindTexture(t,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",i),r.drawArrays(5,0,4),r.bindTexture(null,0),r.bindVAO())}_initialize(s){if(this._initialized)return!0;const o=i.attributes,a=e(s,i);if(!a)return!1;const n=new Int8Array(16);n[0]=-1,n[1]=-1,n[2]=0,n[3]=0,n[4]=1,n[5]=-1,n[6]=1,n[7]=0,n[8]=-1,n[9]=1,n[10]=0,n[11]=1,n[12]=1,n[13]=1,n[14]=1,n[15]=1;const m=new t(s,o,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:r.createVertex(s,35044,n)});return this._program=a,this._vertexArrayObject=m,this._initialized=!0,!0}}export{s as BitBlitRenderer};
