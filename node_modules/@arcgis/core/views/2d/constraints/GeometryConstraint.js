/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../../../chunks/tslib.es6.js";import"../../../core/has.js";import r from"../../../core/Logger.js";import"../../../core/accessorSupport/ensureType.js";import{property as t}from"../../../core/accessorSupport/decorators/property.js";import{subclass as o}from"../../../core/accessorSupport/decorators/subclass.js";import"../../../core/urlUtils.js";import"../../../core/uuid.js";import"../../../portal/support/resourceExtension.js";import s from"../../../core/Accessor.js";import{canProject as i,project as n}from"../../../geometry/support/webMercatorUtils.js";import{extentContainsPoint as m,polygonContainsPoint as a}from"../../../geometry/support/contains.js";import{isLoaded as c,project as p}from"../../../geometry/projection.js";import{nearestCoordinate as l}from"../../../geometry/support/near.js";var y;const u=r.getLogger("esri.views.MapView");let g=y=class extends s{constructor(e){super(e),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){return this.geometry&&this.spatialReference?this.spatialReference.equals(this.geometry.spatialReference)?this.geometry:i(this.geometry,this.spatialReference)?n(this.geometry,this.spatialReference):c()?p(this.geometry,this.spatialReference):(u.error("#constraints.geometry","unsupported coordinate system. The source geometry cannot be projected to the view's coordinate system. The projection engine cannot be loaded.",{geometry:this.geometry}),null):null}constrain(e,r){if(!this.normalizedGeometry)return e;const t=e.targetGeometry;if("extent"===this.normalizedGeometry.type?m(this.normalizedGeometry,t):a(this.normalizedGeometry,t))return e;const{coordinate:o}=l(this.normalizedGeometry,t);return o?(e.targetGeometry=o,e):e}clone(){var e,r;return new y({geometry:null==(e=this.geometry)?void 0:e.clone(),spatialReference:null==(r=this.spatialReference)?void 0:r.clone()})}};e([t({constructOnly:!0})],g.prototype,"geometry",void 0),e([t({readOnly:!0,dependsOn:["geometry","spatialReference"]})],g.prototype,"normalizedGeometry",null),e([t({constructOnly:!0})],g.prototype,"spatialReference",void 0),g=y=e([o("esri.views.2d.constraints.GeometryConstraint")],g);export{g as GeometryConstraint};
