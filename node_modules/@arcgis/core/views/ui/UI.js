/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as t}from"../../chunks/tslib.es6.js";import"../../core/has.js";import"../../core/Logger.js";import{property as i}from"../../core/accessorSupport/decorators/property.js";import{cast as e}from"../../core/accessorSupport/decorators/cast.js";import{subclass as o}from"../../core/accessorSupport/decorators/subclass.js";import"../../core/urlUtils.js";import"../../core/uuid.js";import"../../portal/support/resourceExtension.js";import n from"../../core/Evented.js";import s from"../../core/Handles.js";import{init as r}from"../../core/watchUtils.js";import{empty as a,insertBefore as d}from"../../core/domUtils.js";import{isRTL as p}from"../../widgets/support/widgetUtils.js";import c from"./Component.js";const l={left:0,top:0,bottom:0,right:0},h={bottom:30,top:15,right:15,left:15},m="esri-ui",u="esri-ui-corner",_="esri-ui-inner-container",f="esri-ui-manual-container",g="esri-ui-corner-container",y="esri-ui-top-left",C="esri-ui-top-right",v="esri-ui-bottom-left",w="esri-ui-bottom-right";function P(t){return"object"==typeof t&&!(t instanceof c)&&!("declaredClass"in t)&&("component"in t||"index"in t||"position"in t)?t:null}function L(t,{top:i,bottom:e,left:o,right:n}){t.style.top=i,t.style.bottom=e,t.style.left=o,t.style.right=n}let b=class extends n.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new s,this.view=null,this._initContainers()}initialize(){this._handles.add([r(this,"view.padding, container",this._applyViewPadding.bind(this)),r(this,"padding",this._applyUIPadding.bind(this))])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}set container(t){const i=this._get("container");t!==i&&(t&&(t.classList.add(m),this._attachContainers(t)),i&&(i.classList.remove(m),L(i,{top:"",bottom:"",left:"",right:""}),a(i)),this._set("container",t))}get height(){const t=this.get("view.height")||0;if(0===t)return t;const i=this._getViewPadding(),e=i.top+i.bottom;return Math.max(t-e,0)}get padding(){return this._get("padding")}set padding(t){t?this._override("padding",t):this._clearOverride("padding")}castPadding(t){return"number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...h,...t}}get width(){const t=this.get("view.width")||0;if(0===t)return t;const i=this._getViewPadding(),e=i.left+i.right;return Math.max(t-e,0)}add(t,i){let e,o;if(Array.isArray(t))return void t.forEach((t=>this.add(t,i)));const n=P(t);n&&({index:e,position:i,component:t,key:o}=n),i&&"object"==typeof i&&({index:e,key:o,position:i}=i),!t||i&&!this._isValidPosition(i)||this._add(t,i,e,o)}remove(t,i){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,i)));const e=this._find(t);if(e){const o=this._componentToKey;if(o.has(t)&&o.get(t)!==i)return;const n=this._components.indexOf(e);return e.node.parentNode&&e.node.parentNode.removeChild(e.node),this._componentToKey.delete(t),this._components.splice(n,1)[0]}}empty(t){if(Array.isArray(t))return t.map((t=>this.empty(t))).reduce(((t,i)=>t.concat(i)));if("manual"===(t=t||"manual")){return Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(u))).map((t=>this.remove(t)))}return this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null}move(t,i){if(Array.isArray(t)&&t.forEach((t=>this.move(t,i))),!t)return;let e;const o=P(t)||P(i);if(o&&(e=o.index,i=o.position,t=o.component||t),i&&!this._isValidPosition(i))return;const n=this.remove(t);n&&this.add(n,{position:i,index:e})}find(t){if(!t)return null;const i=this._findById(t);return i&&(i.widget||i.node)}_add(t,i,e,o){t instanceof c||(t=new c({node:t})),this._place({component:t,position:i,index:e}),this._components.push(t),o&&this._componentToKey.set(t,o)}_find(t){return t?t instanceof c?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.get("view.padding")||l}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add(_),t.classList.add(g);const i=document.createElement("div");i.classList.add(_),i.classList.add(f);const e=document.createElement("div");e.classList.add(y),e.classList.add(u),t.appendChild(e);const o=document.createElement("div");o.classList.add(C),o.classList.add(u),t.appendChild(o);const n=document.createElement("div");n.classList.add(v),n.classList.add(u),t.appendChild(n);const s=document.createElement("div");s.classList.add(w),s.classList.add(u),t.appendChild(s),this._innerContainer=t,this._manualContainer=i;const r=p();this._cornerNameToContainerLookup={"top-left":e,"top-right":o,"bottom-left":n,"bottom-right":s,"top-leading":r?o:e,"top-trailing":r?e:o,"bottom-leading":r?s:n,"bottom-trailing":r?n:s},this._positionNameToContainerLookup={manual:i,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){const i=t.component,e=t.position||"manual",o=t.index,n=this._positionNameToContainerLookup[e],s=o>-1;let r,a,p;var c;(c=i.widget)&&!c._started&&"function"==typeof c.postMixInProperties&&"function"==typeof c.buildRendering&&"function"==typeof c.postCreate&&"function"==typeof c.startup&&i.widget.startup(),s?(r=Array.prototype.slice.call(n.children),a=0===o,a?n.firstChild?d(i.node,n.firstChild):n.appendChild(i.node):(p=o>=r.length,p?n.appendChild(i.node):d(i.node,r[o]))):n.appendChild(i.node)}_applyViewPadding(){const t=this.container;t&&L(t,this._toPxPosition(this._getViewPadding()))}_applyUIPadding(){const t=this._innerContainer;t&&L(t,this._toPxPosition(this.padding))}_toPxPosition(t){return{top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}}_toPxUnit(t){return 0===t?"0":t+"px"}_findByComponent(t){let i,e=null;return this._components.some((o=>(i=o===t,i&&(e=o),i))),e}_findById(t){let i,e=null;return this._components.some((o=>(i=o.id===t,i&&(e=o),i))),e}_findByNode(t){let i,e=null;return this._components.some((o=>(i=o.node===t,i&&(e=o),i))),e}};t([i()],b.prototype,"container",null),t([i({dependsOn:["view.height"]})],b.prototype,"height",null),t([i({value:h})],b.prototype,"padding",null),t([e("padding")],b.prototype,"castPadding",null),t([i()],b.prototype,"view",void 0),t([i({dependsOn:["view.width"]})],b.prototype,"width",null),b=t([o("esri.views.ui.UI")],b);var x=b;export default x;
