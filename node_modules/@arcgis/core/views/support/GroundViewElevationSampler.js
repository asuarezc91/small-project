/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import"../../core/has.js";import t from"../../core/Logger.js";import"../../core/accessorSupport/ensureType.js";import{property as r}from"../../core/accessorSupport/decorators/property.js";import{subclass as o}from"../../core/accessorSupport/decorators/subclass.js";import"../../core/urlUtils.js";import"../../core/uuid.js";import"../../portal/support/resourceExtension.js";import{canProject as i}from"../../geometry/support/webMercatorUtils.js";import{extentContainsPoint as s}from"../../geometry/support/contains.js";import a from"../../core/Evented.js";import{toExtent as n}from"../../geometry/support/aaBoundingRect.js";import{updateGeometryElevation as p}from"../../layers/support/ElevationSampler.js";import{getElevationAtPoint as l}from"../3d/support/ElevationProvider.js";import{ELEVATION_NODATA_VALUE as m}from"../3d/terrain/TerrainConst.js";const c=t.getLogger("esri.views.support.GroundViewElevationSampler");let u=class extends a.EventedAccessor{constructor(e){super(e),this.demResolution={min:-1,max:-1},this.noDataValue=m}initialize(){this.view.basemapTerrain.on("elevation-change",(()=>this.emit("changed",{})))}get extent(){const e=this.view.basemapTerrain;return e.extent&&e.spatialReference?n(e.extent,e.spatialReference):null}elevationAt(e){const t=e.spatialReference,r=this.spatialReference;if(!i(t,r)){const e=t?t.wkid:"unknown";return c.error(`Cannot sample elevation at a location with spatial reference (${e}) different from the view (${r.wkid})`),null}if(!s(this.extent,e)){const t=this.extent,r=`${t.xmin}, ${t.ymin}, ${t.xmax}, ${t.ymax}`;c.warn("#elevationAt()",`Point used to sample elevation (${e.x}, ${e.y}) is outside of the sampler extent (${r})`)}return l(this.view.elevationProvider,e)}queryElevation(e){return p(e.clone(),this)}};e([r({readOnly:!0})],u.prototype,"demResolution",void 0),e([r({readOnly:!0,dependsOn:["view.basemapTerrain.extent","view.basemapTerrain.spatialReference"]})],u.prototype,"extent",null),e([r({readOnly:!0})],u.prototype,"noDataValue",void 0),e([r({readOnly:!0,aliasOf:"view.basemapTerrain.spatialReference"})],u.prototype,"spatialReference",void 0),e([r({constructOnly:!0})],u.prototype,"view",void 0),u=e([o("esri.views.support.GroundViewElevationSampler")],u);var d=u;export default d;
