/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import"../../core/has.js";import{isSome as t,unwrapOr as o}from"../../core/maybe.js";import"../../core/Logger.js";import"../../core/accessorSupport/ensureType.js";import{property as r}from"../../core/accessorSupport/decorators/property.js";import{subclass as s}from"../../core/accessorSupport/decorators/subclass.js";import"../../core/urlUtils.js";import"../../core/uuid.js";import"../../portal/support/resourceExtension.js";import i from"../../core/Evented.js";import{createScreenPointArray as n}from"../../core/screenUtils.js";let a=class extends i.EventedAccessor{constructor(){super(...arguments),this._hasZ=null,this.interactiveUndoDisabled=!1,this.history=[],this.redoHistory=[],this.snapToScene=!1,this.view=null,this.elevationInfo=null,this.defaultZ=0}get hasZ(){return t(this._hasZ)?this._hasZ:"3d"===this.view.type}set hasZ(e){this._hasZ=e,this.notifyChange("hasZ")}canUndo(){return this.history.length>0}canRedo(){return this.redoHistory.length>0}undo(){if(!this.canUndo())return;const e=this.history.pop();e.undo(),this.redoHistory.push(e)}redo(){if(!this.canRedo())return;const e=this.redoHistory.pop();e.redo(),this.history.push(e)}getCoordsFromScreenPoint(e){const o=this.screenToMap(e);return t(o)?o.hasZ?[o.x,o.y,o.z]:[o.x,o.y]:null}getCoordsAndPointFromScreenPoint(e){const o=this.screenToMap(e);return t(o)?o.hasZ?{vertex:[o.x,o.y,o.z],mapPoint:o}:{vertex:[o.x,o.y],mapPoint:o}:null}isDuplicateVertex(e,t){if(e.length){const[o,r]=e[e.length-1];return o===t[0]&&r===t[1]}return!1}getGeometryZValue(){return this.defaultZ}screenToMap(e){let r=null;if("3d"===this.view.type)if(this.hasZ){const t=o(this.elevationInfo,h);r=this.view.sceneIntersectionHelper.intersectElevationFromScreen(n(e.x,e.y),t,this.getGeometryZValue())}else{const s=o(this.elevationInfo,p);r=this.view.sceneIntersectionHelper.intersectElevationFromScreen(n(e.x,e.y),s,0),t(r)&&(r.z=void 0)}else r=this.view.toMap(e),t(r)&&(r.z=this.hasZ?this.getGeometryZValue():void 0);return r}};e([r({type:Boolean,nonNullable:!0})],a.prototype,"interactiveUndoDisabled",void 0),e([r({readOnly:!0})],a.prototype,"history",void 0),e([r({readOnly:!0})],a.prototype,"redoHistory",void 0),e([r()],a.prototype,"snapToScene",void 0),e([r()],a.prototype,"view",void 0),e([r()],a.prototype,"elevationInfo",void 0),e([r({nonNullable:!0})],a.prototype,"defaultZ",void 0),e([r({dependsOn:["view"]})],a.prototype,"hasZ",null),a=e([s("esri.views.draw.DrawAction")],a);const h={mode:"absolute-height",offset:0},p={mode:"on-the-ground",offset:0};var c=a;export default c;
