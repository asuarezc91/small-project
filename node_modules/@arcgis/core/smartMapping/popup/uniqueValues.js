/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import e from"../../core/Error.js";import{all as r}from"../../core/promiseUtils.js";import n from"../../PopupTemplate.js";import{fetchMessageBundle as s}from"../../intl/messages.js";import{getContentFromFieldInfos as t,hasNormalizedField as a,getFieldAndExpressionInfos as i}from"./support/utils.js";async function o(r){const{layer:n,renderer:s}=r;await n.load();const t=s||n.renderer;if("unique-value"!==t.type)throw new e("unique-values-popup:invalid-parameters","renderer.type must be 'unique-value'");return{layer:n,renderer:t}}async function u(e,r,s="divide"){const{fieldInfos:a,expressionInfos:o}=await i({renderer:e,layer:r,normFieldExpressionTemplate:s});return new n({content:await t(r,{fieldInfos:a,expressionInfos:o}),fieldInfos:a,expressionInfos:o})}async function p(e){const[{renderer:n,layer:t},i]=await r([o(e),s("esri/smartMapping/t9n/smartMapping")]),p={name:"unique-values",title:i.uniqueValues,value:await u(n,t)},l=[];return a(n)&&l.push({name:"unique-values-percent",title:i.uniqueValuesNormFieldAsPercent,value:await u(n,t,"percentage")}),{primaryTemplate:p,secondaryTemplates:l}}export{p as getTemplates};
