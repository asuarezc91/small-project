/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import e from"../../../core/Error.js";import{createStretchRenderer as r,getDefaultBandCombination as t}from"../../../renderers/support/rasterRendererHelper.js";import{processRasterRendererParameters as n}from"../support/utils.js";async function a(a){const s=(a=await async function(r){r=await n(r);const{rasterInfo:a}=r.layer;if(1===a.bandCount)throw new e("raster-rgb-renderer:not-supported","Only multiband image is supported");const{rgbBandIds:s}=r;if(s&&3!==s.length)throw new e("raster-rgb-renderer:invalid-parameters","rgb band ids must have exactly three 0-based band indices");return s||(r.rgbBandIds=t(a)),r}(a)).layer,{rasterInfo:d}=s,{rgbBandIds:i}=a,o={bandIds:i,stretchType:a.stretchType};let m=r(d,o);return a.estimateStatistics&&m.dynamicRangeAdjustment&&(await s.updateRasterInfoWithEstimatedStats({renderingRule:a.renderingRule,signal:a.signal}),m=r(d,o)),function(e,r){const{gamma:t,useGamma:n,dynamicRangeAdjustment:a}=r;3===(null==t?void 0:t.length)&&(e.gamma=t);null!=n&&(e.useGamma=n);null!=a&&(e.dynamicRangeAdjustment=a)}(m,a),{renderer:m,rgbBandIds:i}}export{a as createRenderer};
