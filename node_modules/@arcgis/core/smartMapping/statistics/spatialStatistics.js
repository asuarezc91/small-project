/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{resolve as t}from"../../core/promiseUtils.js";import{getLength as n,getPathLength as e}from"../../geometry/support/coordsUtils.js";function o(t,e=!1){let o=[];if(e){for(const n of t)if(n.geometry){const t=n.geometry;o.push.apply(o,t.points)}}else o=t.map((t=>t.geometry));const i=[],l=[];let s=1/0,r=-1/0,c=0,f=0,u=0,a=0;for(const t of o){if(!t)continue;e?(i[0]=t[0],i[1]=t[1]):(i[0]=t.x,i[1]=t.y);let m=1/0,p=-1/0;for(const c of o){if(c===t)continue;if(!c)continue;e?(l[0]=c[0],l[1]=c[1]):(l[0]=c.x,l[1]=c.y);const o=n(i,l);o>0&&(o<m&&(m=o),o<s&&(s=o),o>p&&(p=o),o>r&&(r=o))}m!==1/0&&(++u,c+=m),p!==-1/0&&(++a,f+=p)}return{minDistance:s!==1/0?s:null,maxDistance:r!==-1/0?r:null,avgMinDistance:u?c/u:null,avgMaxDistance:a?f/a:null}}function i(n){const{features:i}=n;let l=null;switch(n.geometryType){case"point":l=o(i);break;case"multipoint":l=o(i,!0);break;case"polyline":l=function(t){let n=0,o=0,i=1/0,l=-1/0;for(const s of t){const t=s.geometry;if(t){let s=0;for(const n of t.paths){const t=e(n);t>0&&(s+=t)}s>0&&(++n,o+=s,s<i&&(i=s),s>l&&(l=s))}}return{minLength:i!==1/0?i:null,maxLength:l!==-1/0?l:null,avgLength:n?o/n:null}}(i);break;case"polygon":l=function(t){let n=0,e=0,o=1/0,i=-1/0;for(const l of t){const t=l.geometry;if(t){const l=t.extent;if(l){const t=Math.sqrt(l.width*l.height);t>0&&(++n,e+=t,t<o&&(o=t),t>i&&(i=t))}}}return{minSize:o!==1/0?o:null,maxSize:i!==-1/0?i:null,avgSize:n?e/n:null}}(i)}return t(l)}export default i;
