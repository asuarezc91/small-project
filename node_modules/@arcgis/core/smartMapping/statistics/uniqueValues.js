/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{isSome as e}from"../../core/maybe.js";import r from"../../core/Error.js";import{getFieldsList as s}from"../support/utils.js";import{verifyBasicFieldValidity as i}from"./support/utils.js";import{createLayerAdapter as a,getLayerTypeLabels as n}from"../support/adapters/support/layerUtils.js";async function o(o){const{layerAdapter:t,...u}=await async function(o){if(!o||!o.layer||!o.field&&!o.valueExpression)throw new r("unique-values:missing-parameters","'layer' and 'field' or 'valueExpression' parameters are required");const t=o.valueExpression||o.sqlExpression,u=t&&!o.sqlExpression;if(t)if(u){if(!o.view)throw new r("unique-values:missing-parameters","View is required when 'valueExpression' is specified")}else if(!o.valueExpression)throw new r("unique-values:missing-parameters","'valueExpression' parameters are required");const l=[0,2,1,3,4],{layer:p,...m}=o,f=a(p,l),d={layerAdapter:f,...m};if(!f)throw new r("unique-values:invalid-parameters","'layer' must be one of these types: "+n(l).join(", "));const v=e(d.signal)?{signal:d.signal}:null;await f.load(v);const w=await s({field:d.field,valueExpression:d.valueExpression}),c=i(f,w,"unique-values:invalid-parameters");if(c)throw c;return d}(o);return t.uniqueValues(u)}export default o;
