/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{collectClassPaths as e}from"./utils.js";function n(n){const t=function(n){const t=e(n.api),p=e(n.spec),i={};i[""]={api:n.api,spec:n.spec};for(const e in t){const n=p[e];if(n){const p=t[e];i[e]={api:p,spec:n}}}return i}(n),i=[],o=function(e){const n={api:{},spec:{}};for(const t in e){const p=e[t],i=`${p.api.name} (${p.spec.name})${p.api.typeValue?` <${p.api.typeValue}>`:""}`;let o=n.api[p.api.id];o||(o=new Set,n.api[p.api.id]=o),o.add(i);let a=n.spec[p.spec.id];a||(a=new Set,n.spec[p.spec.id]=a),a.add(i)}return n}(t),a={};p("api","",n.api,t,o.api,a);const c={};p("spec","",n.spec,t,o.spec,c);const r=function(e){const n={};for(const t in e){const p=t?t.split(".").length:0,i=e[t].api.id;n[i]=i in n?Math.min(p,n[i]):p}return n}(t);for(const e in a){const n=a[e],t=c[e],p=r[n.container.id],o=`${n.container.name} (${t.container.name})${n.container.typeValue?` <${n.container.typeValue}>`:""}`;i.push({name:o,api:n,spec:t,indent:p})}return i}function t(e,n,o,a,c,r,s,u,f){if(s.has(a))return f;for(const l of a.properties){const d=n?`${n}.${l.name}`:l.name,m=o?`${o}.${l.name}`:l.name,y=c[m];if(y){const n=r[y[e].id];f.push({name:d,type:"ref",ref:y,refName:n}),p(e,m,y[e],c,r,u)}else"string"==typeof l.type?f.push(i(d,l)):(s.add(a),t(e,d,m,l.type,c,r,s,u,f))}return s.delete(a),f}function p(e,n,p,i,a,c){if(p.id in c)return c;const r={container:p,text:null,props:[]};return a[p.id].forEach((e=>c[e]=r)),t(e,"",n,p,i,a,new Set,c,r.props),r.props.sort(o),c}function i(e,n){return{name:e,type:n.enum||("string"==typeof n.type?n.type:""),default:JSON.stringify(n.default)}}function o(e,n){const t=e.name.localeCompare(n.name);if(0!==t)return t;const p=(e.type||"").localeCompare(n.type||"");return 0!==p?p:(e.default||"").localeCompare(n.default||"")}export{n as collect};
