/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{isNone as r}from"../core/maybe.js";import{castRenderScreenPointArray3 as n}from"../core/screenUtils.js";import{b as e,c as o}from"./vec3f64.js";import{g as t,f as i,s as c,c as s,n as a,d as u,b as f,a as g}from"./vec3.js";import{ObjectStack as d}from"../core/ObjectStack.js";import{c as m}from"./vec2.js";import{sv3d as p}from"../views/3d/support/stack.js";function l(r){return r?{origin:e(r.origin),direction:e(r.direction)}:{origin:o(),direction:o()}}function j(r,n){const e=E.get();return e.origin=r,e.direction=n,e}function R(r,n=l()){return S(r.origin,r.direction,n)}function b(r,n,e=l()){return t(e.origin,r),i(e.direction,n,r),e}function S(r,n,e=l()){return t(e.origin,r),t(e.direction,n),e}function v(r,e,o=l()){return y(r,r.screenToRender(e,n(p.get())),o)}function y(e,o,t=l()){const c=n(m(p.get(),o));if(c[2]=0,!e.unprojectFromRenderScreen(c,t.origin))return null;const s=n(m(p.get(),o));s[2]=1;const a=e.unprojectFromRenderScreen(s,p.get());return r(a)?null:(i(t.direction,a,t.origin),t)}function w(r,e,o=l()){return _(r,r.screenToRender(e,n(p.get())),o)}function _(n,e,o=l()){t(o.origin,n.eye);const s=c(p.get(),e[0],e[1],1),a=n.unprojectFromRenderScreen(s,p.get());return r(a)?null:(i(o.direction,a,o.origin),o)}function k(r,n){const e=s(p.get(),a(p.get(),r.direction),i(p.get(),n,r.origin));return u(e,e)}function F(r,n){return Math.sqrt(k(r,n))}function h(r,n,e){const o=u(r.direction,i(e,n,r.origin));return f(e,r.origin,g(e,r.direction,o)),e}function A(){return{origin:null,direction:null}}const E=new d(A);var O=Object.freeze({__proto__:null,create:l,wrap:j,copy:R,fromPoints:b,fromValues:S,fromScreen:v,fromRender:y,fromScreenAtEye:w,fromRenderAtEye:_,distance2:k,distance:F,closestPoint:h,createWrapper:A});export{v as a,R as b,l as c,k as d,S as e,_ as f,w as g,h,b as i,y as j,F as k,A as l,O as r,j as w};
