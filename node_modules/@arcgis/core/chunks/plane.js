/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{isSome as n}from"../core/maybe.js";import{clamp as t}from"../core/mathUtils.js";import{c as r}from"./vec3f64.js";import{g as e,d as o,a as i,f as s,m as c,n as u,c as a,b as f}from"./vec3.js";import{sv4d as m,sv3d as g}from"../views/3d/support/stack.js";function l(n=Q){return[n[0],n[1],n[2],n[3]]}function p(n,t,r,e){return y(n,t,r,e,m.get())}function d(n,t=l()){return y(n[0],n[1],n[2],n[3],t)}function y(n,t,r,e,o=l()){return o[0]=n,o[1]=t,o[2]=r,o[3]=e,o}function h(n,t,r=l()){return e(r,n),r[3]=t,r}function P(n,t,r=l()){e(r,t);const s=o(t,t);return Math.abs(s-1)>1e-5&&s>1e-12&&i(r,r,1/Math.sqrt(s)),F(r,n,r),r}function j(n,t,r,e=l()){return _(s(g.get(),n,t),s(g.get(),r,t),n,e)}function M(n,t){return b(n,t,0,1,2)}function b(n,t,r,e,i){if(n.count<3)return!1;n.getVec(r,A);let a=e,f=!1;for(;a<n.count-1&&!f;)n.getVec(a,V),a++,f=!c(A,V);if(!f)return!1;for(a=Math.max(a,i),f=!1;a<n.count&&!f;)n.getVec(a,O),a++,s(S,A,V),u(S,S),s(x,V,O),u(x,x),f=!c(A,O)&&!c(V,O)&&Math.abs(o(S,x))<v;return f?(j(A,V,O,t),!0):(0!==r||1!==e||2!==i)&&b(n,t,0,1,2)}const v=.99619469809,A=r(),V=r(),O=r(),S=r(),x=r();function F(n,t,r){return n!==r&&d(n,r),r[3]=-o(r,t),r}function I(n,t){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function _(n,t,r,e=l()){return P(r,a(g.get(),t,n),e)}function w(t,r,e){return!!n(r)&&J(t,r.origin,r.direction,!0,!1,e)}function B(n,t,r){return J(n,t.origin,t.vector,!1,!1,r)}function U(n,t,r){return J(n,t.origin,t.vector,!1,!0,r)}function k(n,t){const{center:r,radius:e}=t;return H(n,r)-e>=0}function q(n,t){const{center:r,radius:e}=t;return H(n,r)+e<0}function z(n,t){return H(n,t)>=0}function L(n,t){return H(n,t)<0}function N(n,t){const r=t[0],e=t[1],o=t[2],i=t[3],s=t[4],c=t[5];return n[0]*(n[0]>0?r:i)+n[1]*(n[1]>0?e:s)+n[2]*(n[2]>0?o:c)+n[3]>=0}function C(n,t){const r=o(n,t.ray.direction),e=-H(n,t.ray.origin);if(e<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return e>0;if((e<0||r<0)&&!(e<0&&r<0))return!0;const i=e/r;return r>0?i<t.c1&&(t.c1=i):i>t.c0&&(t.c0=i),t.c0<=t.c1}function D(n,t){const r=o(n,t.ray.direction),e=-H(n,t.ray.origin);if(r>-1e-6&&r<1e-6)return e>0;const i=e/r;return r>0?i<t.c1&&(t.c1=i):i>t.c0&&(t.c0=i),t.c0<=t.c1}function R(n,t,r){const e=i(g.get(),n,-n[3]),o=E(n,s(g.get(),t,e),g.get());return f(r,o,e),r}function E(n,t,r){const e=i(g.get(),n,o(n,t));return s(r,t,e),r}function G(n,t){return Math.abs(H(n,t))}function H(n,t){return o(n,t)+n[3]}function J(n,r,e,s,c,u){const a=o(n,e);if(0===a)return!1;let m=-(o(n,r)+n[3])/a;return c&&(m=s?Math.max(0,m):t(m,0,1)),!(m<0||!s&&m>1)&&(f(u,r,i(u,e,m)),!0)}function K(n){return n}const Q=[0,0,1,0];var T=Object.freeze({__proto__:null,create:l,wrap:p,copy:d,fromValues:y,fromNormalAndOffset:h,fromPositionAndNormal:P,fromPoints:j,fromManyPoints:M,fromManyPointsSampleAt:b,setOffsetFromPoint:F,negate:I,fromVectorsAndPoint:_,intersectRay:w,intersectLineSegment:B,intersectLineSegmentClamp:U,isSphereFullyInside:k,isSphereFullyOutside:q,isPointInside:z,isPointOutside:L,isAABBFullyInside:N,clip:C,clipInfinite:D,projectPoint:R,projectVector:E,distance:G,signedDistance:H,normal:K,UP:Q});export{E as A,G as B,Q as U,y as a,B as b,l as c,U as d,z as e,_ as f,T as g,d as h,w as i,j,k,D as l,H as m,K as n,N as o,R as p,C as q,L as r,F as s,b as t,h as u,P as v,p as w,M as x,I as y,q as z};
